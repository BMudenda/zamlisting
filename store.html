<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ZamListing</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"/>
  <style>
    :root {
      --primary: #2e7d32; --primary-dark: #1b5e20; --primary-light: #81c784; --accent: #ff9800;
      --text: #222; --text-light: #666; --background: #f5f5f5; --card-bg: white;
      --border: #e0e0e0; --shadow: 0 0 8px rgba(0,0,0,0.05); --success: #e8f5e9;
      --error: #ffebee; --danger: #c62828;
      --whatsapp: #25d366; --sms: #ff9800;
      --footer-bg: #2e7d32;
      --footer-text: #fff;
      --footer-link: #ffd600;
    }
    body { font-family: 'Roboto', sans-serif; color: var(--text); background: var(--background); line-height: 1.5; margin: 0; }
    header { background: linear-gradient(135deg, var(--primary), var(--primary-dark) 90%); color: white; padding: 2.2rem 1rem 1.5rem 1rem; text-align: center;}
    .brand-title { font-size: 2.6rem; font-weight: 900; letter-spacing: 0.05em; color: var(--primary-dark); text-shadow: 0 1px 0 #fff; margin-bottom: 0.6rem; }
    .brand-title .highlight { color: var(--accent); text-shadow: none; }
    .tagline { font-size: 1.45rem; font-weight: 500; color: var(--primary); margin-bottom: 0.45rem; }
    .subtitle { font-size: 1.1rem; color: var(--text-light); margin-bottom: 1.2rem; margin-top: -0.5rem; }
    .container { max-width: 1200px; margin: 2rem auto; padding: 0 1rem; display: flex; flex-direction: column; gap: 2rem; }
    .filter-search-section { width: 100%; margin-bottom: 1.5rem; }
    .filter-search-section > div { display: flex; gap: 1rem; align-items: center; flex-wrap: wrap; }
    .filter-search-section label { font-weight: 500; }
    .filter-search-section select, .filter-search-section input[type="text"] {
      padding: 0.5rem; border-radius: 4px; border: 1px solid #ccc; font-size: 1.06rem; min-width: 120px;
    }
    .slider-section { position: relative; width: 100%; margin-bottom: 2rem; background: var(--card-bg); border-radius: 12px; box-shadow: var(--shadow); padding: 1.5rem 1rem 1rem; }
    .slider-title { display: flex; align-items: center; gap: 0.7rem; font-size: 1.42rem; margin-bottom: 1.1rem; color: var(--primary-dark); font-weight: 600; }
    .slider-track { display: flex; overflow-x: auto; gap: 1.4rem; scroll-behavior: smooth; padding-bottom: 16px; padding-top: 6px; }
    .slider-btn { position: absolute; top: 50%; transform: translateY(-50%); background: rgba(0,0,0,0.63); border: none; color: white; width: 38px; height: 38px; border-radius: 50%; font-size: 1.3rem;}
    .slider-btn:hover { background: rgba(0,0,0,0.81); }
    .slider-btn.prev { left: 8px; }
    .slider-btn.next { right: 8px; }
    .slider-btn:disabled { background: #ddd; cursor: not-allowed; }
    .slider-section[hidden] { display: none !important; }
    .taxi-card { min-width: 250px; max-width: 270px; margin: 0 auto; background: linear-gradient(120deg, #e0f7fa 60%, #fceabb 100%); border-radius: 15px; box-shadow: 0 2px 22px rgba(0,0,0,0.12); padding: 1.3rem 1rem; transition: box-shadow 0.2s, transform 0.17s;}
    .taxi-card:hover { box-shadow: 0 7px 26px rgba(0,0,0,0.15); transform: scale(1.04); cursor: pointer;}
    .taxi-emoji-animated { width: 100%; display: flex; align-items: center; justify-content: center; gap: 0.7rem; font-size: 2.9rem; margin: 0.7rem 0 0.3rem 0; animation: taxiEmojiBounce 1.4s infinite;}
    @keyframes taxiEmojiBounce { 0% { transform: translateY(0); } 50% { transform: translateY(-10px) scale(1.07); } 100% { transform: translateY(0); } }
    .taxi-card-title { font-size: 1.17rem; font-weight: 600; color: var(--primary-dark); display: flex; align-items: center; gap: 0.4rem; justify-content: center; margin-bottom: 0.15rem; }
    .taxi-card-desc { color: var(--text-light); font-size: 1.01rem; text-align: center; margin-bottom: 0.2rem; }
    .fa {
      padding: 5px;
      font-size: 18px;
      width: 34px;
      height: 34px;
      line-height: 18px;
      text-align: center;
      text-decoration: none;
      margin: 3px;
      border-radius: 50%;
      color: white;
      display: inline-block;
      vertical-align: middle;
    }
    .fa-whatsapp { background: #25d366; }
    .fa-comment { background: #ff9800; }
    .taxi-hire-actions, .bid-actions { display: flex; gap: 7px; align-items: center; justify-content: center; margin: 0.8rem 0 0.2rem 0;}
    .taxi-hire-btn, .bid-btn {
      border: none;
      background: none;
      padding: 0 8px;
      font-size: 1em;
      font-weight: 600;
      color: inherit;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      border-radius: 50%;
      min-width: 34px;
      min-height: 34px;
    }
    .taxi-hire-btn.calc, .taxi-hire-btn.map, .taxi-hire-btn.hide,
    .bid-btn.sms, .bid-btn.whatsapp {
      font-size: 1em;
      background: none;
      color: inherit;
      border-radius: 50%;
      min-width: 34px;
      min-height: 34px;
      padding: 0 8px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .taxi-hire-btn.calc i { color: #ff9800; }
    .taxi-hire-btn.map i { color: #00897b; }
    .taxi-hire-btn.hide i { color: #d32f2f; }
    .taxi-hire-btn.sms .fa-comment, .taxi-hire-btn.whatsapp .fa-whatsapp,
    .bid-btn.sms .fa-comment, .bid-btn.whatsapp .fa-whatsapp { margin-right: 4px;}
    .taxi-hire-btn:disabled, .bid-btn:disabled { background: #ddd; color: #aaa; cursor: not-allowed;}
    .taxi-hire-status { margin: 0.7rem auto 0.2rem auto; text-align: center; font-size: 1.03em;}
    .taxi-hire-status.success { color: var(--primary-dark);}
    .taxi-hire-status.error { color: var(--danger);}
    .taxi-hire-map { display: none; width: 100%; max-height: 60vh; border: none; margin: 0.5rem 0; border-radius: 8px; background: #f8fafc; align-items: center; justify-content: center; color: #2563eb;}
    .taxi-hire-map.show { display: flex !important; }
    .taxi-hire-map iframe { width: 100%; height: 60vh; max-height: 400px; border: none; border-radius: 8px; }
    .taxi-radio-group { display: flex; gap: 18px; margin-bottom: 0.7rem; }
    .taxi-radio-label { display: flex; align-items: center; gap: 6px; }
    .taxi-radio-label input[type="radio"] { accent-color: var(--primary); }
    .product, .vehicle-item { min-width: 160px; max-width: 170px; border: 1px solid var(--border); border-radius: 10px; padding: 1rem 0.7rem; text-align: center; background: var(--card-bg); transition: box-shadow 0.2s, transform 0.17s;}
    .product:hover, .vehicle-item:hover { transform: translateY(-7px) scale(1.04); box-shadow: 0 7px 26px rgba(0,0,0,0.15);}
    .product img, .vehicle-item img { width: 120px; height: 82px; object-fit: cover; margin-bottom: 0.5rem; border-radius: 4px; border: 2px solid var(--primary-light); background: #fff; }
    .product h4, .vehicle-item h4 { font-size: 1rem; margin-bottom: 0.2rem; color: var(--text); }
    .product p, .vehicle-item p { color: var(--primary-dark); font-weight: 600; margin-bottom: 0.6rem; }
    .vehicle-item p.location { font-size: 0.9rem; color: var(--text-light); margin-bottom: 0.2rem;}
    .product .out-stock { display: block; color: #b71c1c; font-size: 0.97em; font-weight: 600; margin-bottom: 0.7em; }
    .product button, .vehicle-item button { border: none; background: var(--primary); color: white; padding: 0.4rem 0.8rem; border-radius: 5px; cursor: pointer; font-family: inherit; font-weight: 500;}
    .product button:disabled { background: #ccc !important; cursor: not-allowed; }
    .cart { border: 1px solid var(--border); padding: 1.7rem 1.3rem 2.1rem; border-radius: 10px; flex: 1; min-width: 300px; background: var(--card-bg); position: sticky; top: 1rem; box-shadow: var(--shadow);}
    .cart-items { list-style: none; padding: 0; margin: 0 0 1.5rem; max-height: 320px; overflow-y: auto; }
    .cart-items li { padding: 0.8rem 0; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; gap: 0.2em; animation: fadein 0.33s; min-height: 54px;}
    .cart-items li:last-child { border-bottom: none; }
    .cart-thumb { width: 36px; height: 36px; object-fit: cover; border-radius: 4px; margin-right: 8px; vertical-align: middle; border: 1.5px solid #e5e7eb; background: #fff; }
    .cart-item-info { display: flex; align-items: center; flex: 1; min-width: 0; }
    .cart-item-title { font-weight: 500; font-size: 1.04em; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .cart-item-qty { width: 44px; font-size: 1em; margin: 0 6px; padding: 2px 6px; border-radius: 4px; border: 1px solid #ddd; text-align: center; }
    .cart-price-block { display: flex; align-items: center; gap: 4px; }
    .quantity-controls { display: flex; align-items: center; gap: 2px; }
    .quantity-btn, .remove-btn { border: none; background: none; color: var(--primary-dark); font-size: 1.1em; margin: 0 2px; cursor: pointer; padding: 2px 6px; border-radius: 4px; transition: background 0.2s;}
    .quantity-btn:active, .remove-btn:active { background: #f1f1f1; }
    .remove-btn { color: var(--danger); }
    .cart-total { margin: 1rem 0; padding-top: 1rem; border-top: 1px solid var(--border); }
    .cart-total p { margin: 0.5rem 0; }
    .checkout-actions { margin-top: 1rem; display: flex; gap: 10px; justify-content: center;}
    .checkout-btn-sms, .checkout-btn-whatsapp { border: none; background: none; padding: 0 8px; font-size: 1em; font-weight: 600; color: inherit; display: flex; align-items: center; }
    .checkout-btn-sms .fa-comment, .checkout-btn-whatsapp .fa-whatsapp { margin-right: 4px;}
    .status-message { margin: 0.7rem auto 0.2rem auto; text-align: center; font-size: 1.03em;}
    .status-message.success { color: var(--primary-dark);}
    .status-message.error { color: var(--danger);}
    .modal { display: none; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0,0,0,0.5); z-index: 2000; align-items: center; justify-content: center; overflow: auto; }
    .modal.show { display: flex !important; }
    .modal-content { background: #fff; border-radius: 8px; padding: 1.5rem; max-width: 90vw; max-height: 90vh; width: 100%; height: auto; position: relative; display: flex; flex-direction: column; align-items: center; justify-content: center; overflow-y: auto; box-sizing: border-box;}
    .modal-close { position: fixed; top: 1rem; right: 1rem; font-size: 2rem; color: var(--danger); background: none; border: none; cursor: pointer; z-index: 3; transition: color 0.2s;}
    .modal-close:hover { color: var(--primary-dark);}
    .modal-title { font-size: 1.8rem; font-weight: 700; color: var(--primary-dark); margin: 1rem 0 0.8rem 0; text-align: center;}
    .modal-img { width: 80vw; max-width: 600px; height: auto; max-height: 400px; object-fit: cover; border-radius: 9px; margin-bottom: 0.5rem; border: 1.5px solid #eee; background: #fff;}
    .modal-imgs { display: flex; align-items: center; gap: 10px; margin-bottom: 0.3rem; flex-wrap: wrap; justify-content: center;}
    .modal-imgs img { width: 60px; height: 60px; object-fit: cover; border-radius: 4px; border: 2px solid var(--primary-light); cursor: pointer; transition: box-shadow 0.15s; background: #fff;}
    .modal-imgs img.selected { box-shadow: 0 0 0 3px var(--primary-light); }
    .modal-slider-arrows { display: flex; gap: 8px; align-items: center; margin-bottom: 0.3rem; margin-top: 0.1rem;}
    .modal-slider-arrow { background: var(--primary-light); border: none; border-radius: 50%; width: 32px; height: 32px; font-size: 1.2rem; cursor: pointer; color: #fff; transition: background 0.18s;}
    .modal-slider-arrow:disabled { background: #ddd; color: #aaa; cursor: not-allowed;}
    .masampo-bid-block { margin: 0.7rem 0 0.2rem 0; width: 100%; max-width: 500px; }
    .masampo-bid-block input, .masampo-bid-block label { display: block; width: 100%; font-size: 1.06rem; margin-bottom: 0.55rem; }
    .masampo-bid-block label { font-weight: 500; }
    .masampo-bid-block .bid-actions { display: flex; gap: 14px; justify-content: center; margin-top: 0.4rem; }
    .bid-status { margin: 0.4rem auto 0.1rem auto; text-align: center; font-size: 1.02em; }
    .bid-status.success { color: var(--primary-dark); }
    .bid-status.error { color: var(--danger); }
    .bid-label { font-size: 0.95em; color: var(--text-light); margin-bottom: 8px; display: block; }
    .bid-dest-label { font-weight: 600; font-size: 0.99em; margin-bottom: 3px; }
    footer {
      background: var(--footer-bg);
      color: var(--footer-text);
      text-align: center;
      padding: 1.5rem 1rem 1.7rem 1rem;
      border-radius: 18px 18px 0 0;
      font-size: 1.08rem;
      margin-top: 2.7rem;
      box-shadow: 0 -2px 8px rgba(0,0,0,0.04);
    }
    footer a { color: var(--footer-link); text-decoration: underline; font-weight: 500; }
    footer .footer-brand { font-weight: bold; color: var(--footer-link); }
    @media (max-width: 800px) {
      .modal-content { padding: 1rem; max-width: 95vw; max-height: 95vh; }
      .modal-title { font-size: 1.5rem; }
      .modal-img { width: 90vw; max-width: 400px; max-height: 250px; }
      .modal-imgs img { width: 50px; height: 50px; }
      .taxi-hire-map iframe { height: 50vh; max-height: 300px; }
      .container { margin: 1rem auto; }
      .cart { min-width: 100%; }
      .taxi-hire-actions, .bid-actions { flex-wrap: wrap; }
    }
  </style>
</head>
<body>
  <header>
    <div class="brand-title">Zam<span class="highlight">Listing</span></div>
    <h2 class="tagline">Get your Service</h2>
    <p class="subtitle">Click on a service below to proceed</p>
  </header>
  <div class="container">
    <div class="filter-search-section">
      <div>
        <label for="categoryFilter">Show Section:</label>
        <select id="categoryFilter">
          <option value="all">All</option>
          <option value="taxi">Taxi Hire</option>
          <option value="masampo">Masampo</option>
          <option value="bistore">B-istore</option>
        </select>
        <input type="text" id="searchBox" placeholder="Search products, vehicles..." aria-label="Search products, vehicles">
      </div>
    </div>
    <!-- Taxi Hire Section -->
    <div class="slider-section" id="taxiSliderSection">
      <div class="slider-title"><i class="fa fa-taxi"></i> Taxi Hire</div>
      <button class="slider-btn prev" id="prevTaxiBtn" aria-label="Scroll left"><i class="fa fa-chevron-left"></i></button>
      <div class="slider-track" id="taxi-slider-track">
        <div class="taxi-card" id="taxiCard">
          <div class="taxi-emoji-animated">
            <span role="img" aria-label="vehicle">🚗</span>
            <span role="img" aria-label="motorbike">🏍️</span>
          </div>
          <span class="taxi-card-title"><span role="img" aria-label="taxi">🚕</span> Book a Taxi</span>
          <span class="taxi-card-desc">Hire a vehicle or motorbike for your trip. Quick, safe, and affordable!</span>
        </div>
      </div>
      <button class="slider-btn next" id="nextTaxiBtn" aria-label="Scroll right"><i class="fa fa-chevron-right"></i></button>
    </div>
    <!-- Taxi Hire Modal -->
    <div class="modal" id="taxiHireModal">
      <div class="modal-content">
        <button class="modal-close" id="taxiHireModalClose" title="Close">&times;</button>
        <div class="modal-title">Taxi Hire Booking</div>
        <div style="font-size:2.5rem; margin-bottom:0.6rem;">
          <span>🚗</span>
          <span>🏍️</span>
        </div>
        <div style="width:100%;max-width:500px;">
          <label for="taxiPhoneModal">Phone Number</label>
          <input type="tel" id="taxiPhoneModal" maxlength="10" placeholder="e.g. 0978167546" style="width:100%;margin-bottom:0.7rem;">
          <label>Transport Mode</label>
          <div class="taxi-radio-group">
            <label class="taxi-radio-label">
              <input type="radio" name="taxiHireMode" value="vehicle" checked>
              <span>Vehicle 🚗</span>
            </label>
            <label class="taxi-radio-label">
              <input type="radio" name="taxiHireMode" value="motorbike">
              <span>Motorbike 🏍️</span>
            </label>
          </div>
          <label for="taxiHireFrom">From</label>
          <select id="taxiHireFrom" style="width:100%;margin-bottom:0.7rem;"></select>
          <label for="taxiHireTo">To</label>
          <select id="taxiHireTo" style="width:100%;margin-bottom:0.7rem;"></select>
        </div>
        <div class="taxi-hire-actions">
          <button class="taxi-hire-btn calc" id="taxiCalcBtn" title="Calculate Fare"><i class="fa fa-calculator"></i> Calculate</button>
          <button class="taxi-hire-btn sms" id="taxiSmsBtn" title="Send Booking SMS"><span class="fa fa-comment"></span> Send via SMS</button>
          <button class="taxi-hire-btn whatsapp" id="taxiWhatsappBtn" title="Send Booking WhatsApp"><span class="fa fa-whatsapp"></span> Send via WhatsApp</button>
          <button class="taxi-hire-btn map" id="taxiShowMapBtn" title="Show Map"><i class="fa fa-map"></i> Map</button>
          <button class="taxi-hire-btn hide" id="taxiHideMapBtn" title="Hide Map" style="display:none;"><i class="fa fa-eye-slash"></i> Hide</button>
        </div>
        <div class="taxi-hire-status" id="taxiHireStatus"></div>
        <div id="taxiHireMap" class="taxi-hire-map">
          <iframe id="taxiHireMapIframe" width="100%" height="100%" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
        </div>
      </div>
    </div>
    <!-- Masampo Section -->
    <div class="slider-section" id="masampoSliderSection">
      <div class="slider-title"><i class="fa fa-car"></i> Masampo</div>
      <button class="slider-btn prev" id="prevMasampoBtn" aria-label="Scroll left"><i class="fa fa-chevron-left"></i></button>
      <div class="slider-track" id="masampo-slider-track"></div>
      <button class="slider-btn next" id="nextMasampoBtn" aria-label="Scroll right"><i class="fa fa-chevron-right"></i></button>
    </div>
    <!-- B-istore Section -->
    <div class="slider-section" id="bistoreSliderSection">
      <div class="slider-title"><i class="fa fa-building"></i> B-istore</div>
      <button class="slider-btn prev" id="prevBistoreBtn" aria-label="Scroll left"><i class="fa fa-chevron-left"></i></button>
      <div class="slider-track" id="bistore-slider-track"></div>
      <button class="slider-btn next" id="nextBistoreBtn" aria-label="Scroll right"><i class="fa fa-chevron-right"></i></button>
    </div>
    <!-- Cart System -->
    <div class="cart" aria-label="Your Cart">
      <h2 class="section-title"><i class="fa fa-shopping-cart"></i> Your Order</h2>
      <ul id="cart-items" class="cart-items"></ul>
      <div id="empty-cart" class="empty-cart" aria-live="polite">
        <i class="fa fa-cart-arrow-down"></i>
        <p>Your cart is empty.</p>
        <p>Add items to get started.</p>
      </div>
      <div id="cart-total" class="cart-total" style="display:none;">
        <p>Products Total: ZK <span id="products-total">0.00</span></p>
        <p><strong>Total: ZK <span id="grand-total">0.00</span></strong></p>
      </div>
      <div class="checkout-actions" id="checkoutActions" style="display:none;">
        <button class="checkout-btn-sms" id="checkout-btn-sms" title="Send Order SMS">
          <span class="fa fa-comment"></span> Send via SMS
        </button>
        <button class="checkout-btn-whatsapp" id="checkout-btn-whatsapp" title="Send Order WhatsApp">
          <span class="fa fa-whatsapp"></span> Send via WhatsApp
        </button>
      </div>
      <div id="statusMessage" class="status-message"></div>
    </div>
    <!-- Masampo Details Modal -->
    <div class="modal" id="detailsModal">
      <div class="modal-content">
        <button class="modal-close" id="detailsModalClose">&times;</button>
        <div class="modal-title" id="detailsModalTitle"></div>
        <div class="modal-imgs" id="detailsModalImgs"></div>
        <div class="modal-slider-arrows" id="detailsModalArrows" style="display:none;">
          <button class="modal-slider-arrow" id="detailsModalPrevImg">&lt;</button>
          <button class="modal-slider-arrow" id="detailsModalNextImg">&gt;</button>
        </div>
        <img id="detailsModalImg" class="modal-img" src="" alt="Item Image">
        <div class="modal-details" id="detailsModalDetails"></div>
        <div id="masampoBidBlock" class="masampo-bid-block" style="display:none;">
          <span class="bid-label">Bid/Order will be sent to:</span>
          <span class="bid-dest-label" id="masampoBidDestLabel"></span>
          <label for="masampoBidValue">Your Bid Value (ZK):</label>
          <input type="number" min="1" id="masampoBidValue" placeholder="Enter bid value">
          <label for="masampoBidPhone">Your Phone Number:</label>
          <input type="tel" id="masampoBidPhone" maxlength="10" placeholder="e.g. 0978000000">
          <div class="bid-actions">
            <button class="bid-btn sms" id="masampoBidSms" title="Send Bid SMS">
              <span class="fa fa-comment"></span> Send via SMS
            </button>
            <button class="bid-btn whatsapp" id="masampoBidWhatsapp" title="Send Bid WhatsApp">
              <span class="fa fa-whatsapp"></span> Send via WhatsApp
            </button>
          </div>
          <div class="bid-status" id="masampoBidStatus"></div>
        </div>
      </div>
    </div>
  </div>
  <footer>
    <div class="footer-brand">ZamListing</div>
    <div>
      &copy; 2025 ZamListing &middot; Powered by <a href="https://github.com/">GitHub</a>
    </div>
    <div>
      <span>Contact: <a href="mailto:support@zamlisting.com">support@zamlisting.com</a></span>
    </div>
  </footer>
  <script>
    // --- Taxi Hire Luangwa Places & Segments ---
    const places = [
      "Luangwa (Feira)", "Chitope", "Luangwa Market", "Kasinsa", "Kapoche",
      "Kakaro Primary School", "Makichilo Lodge", "Gerasmos Safari Lodge",
      "Justifeli Lodge", "Kantuleni executive Lodge", "Feira Kindom Hall",
      "Luangwa main sda churh", "Pentocostal Assembly of God Joshua Assembly",
      "UCZ", "JB THREE BOARDERS MALL", "yellow shop", "Anglican Church",
      "Big 2 Zambezi Water Front Resort & Safari", "Luangwa Secondary School",
      "Luangwa District Hospital", "Kavalamanja", "Luangwa Police Station",
      "Zambia Electricity Supply Corporation", "Luangwa Post Office",
      "Luangwa Basic School", "Luangwa Habour", "Luangwa Indeco",
      "Luangwa District Comission office", "Luangwa District Education Board Offices",
      "Luangwa Council lodge", "Yangoma Hotel", "Luangwa Filling Station",
      "Dzalo Skills Training Centre kambolozo", "Boma Clinic", "BM residence",
      "Luangwa Feira Day Secondary School", "Katondwe Mission Hospital",
      "Mwavi Secondary School", "Luangwa Bridge", "Luangwa Bridge Market"
    ];

    const segments = [
      { from: "Luangwa (Feira)", to: "Kapoche", distance: 28 },
      { from: "Luangwa (Feira)", to: "Katondwe Mission Hospital", distance: 52 },
      { from: "Luangwa (Feira)", to: "Luangwa Market", distance: 0.1 },
      { from: "Luangwa Market", to: "Luangwa (Feira)", distance: 0.1 },
      { from: "Luangwa (Feira)", to: "Luangwa District Hospital", distance: 4.6 },
      { from: "Luangwa (Feira)", to: "Kakaro Primary School", distance: 12 },
      { from: "Luangwa District Hospital", to: "Kavalamanja", distance: 23 },
      { from: "Katondwe Mission Hospital", to: "Kasinsa", distance: 16 },
      { from: "Chitope", to: "Kasinsa", distance: 10 },
      { from: "Luangwa (Feira)", to: "Luangwa Police Station", distance: 0.55 },
      { from: "Luangwa (Feira)", to: "Makichilo Lodge", distance: 0.40 },
      { from: "Luangwa (Feira)", to: "Anglican Church", distance: 0.75 },
      { from: "Luangwa (Feira)", to: "Feira Kindom Hall", distance: 0.7 },
      { from: "Luangwa (Feira)", to: "UCZ", distance: 0.5 },
      { from: "Luangwa (Feira)", to: "Pentocostal Assembly of God Joshua Assembly", distance: 0.6 },
      { from: "Luangwa Police Station", to: "Luangwa Post Office", distance: 1.1 },
      { from: "Luangwa Post Office", to: "Luangwa District Comission office", distance: 0 },
      { from: "Luangwa Market", to: "Luangwa Basic School", distance: 0.45 },
      { from: "Luangwa Market", to: "Luangwa Habour", distance: 0.5 },
      { from: "Luangwa (Feira)", to: "Luangwa Indeco", distance: 0.9 },
      { from: "Luangwa Indeco", to: "Luangwa Council lodge", distance: 0.25 },
      { from: "Luangwa Council lodge", to: "Yangoma Hotel", distance: 0.15 },
      { from: "Luangwa Council lodge", to: "Zambia Electricity Supply Corporation", distance: 2.4 },
      { from: "Yangoma Hotel", to: "Luangwa Filling Station", distance: 0.7 },
      { from: "Kantuleni executive Lodge", to: "Luangwa Filling Station", distance: 0.190 },
      { from: "Luangwa Filling Station", to: "Dzalo Skills Training Centre kambolozo", distance: 0.3 },
      { from: "Dzalo Skills Training Centre kambolozo", to: "Boma Clinic", distance: 0.2 },
      { from: "Boma Clinic", to: "BM residence", distance: 0.6 },
      { from: "BM residence", to: "Luangwa Feira Day Secondary School", distance: 1.1 },
      { from: "Gerasmos Safari Lodge", to: "Luangwa Feira Day Secondary School", distance: 3.1 },
      { from: "Luangwa Feira Day Secondary School", to: "Justifeli Lodge", distance: 2.2 },
      { from: "Luangwa main sda churh", to: "Justifeli Lodge", distance: 0.9 },
      { from: "Luangwa District Education Board Offices", to: "Justifeli Lodge", distance: 2.0 },
      { from: "Luangwa Feira Day Secondary School", to: "yellow shop", distance: 3.3 },
      { from: "Luangwa Feira Day Secondary School", to: "Zambia Electricity Supply Corporation", distance: 2.0 },
      { from: "yellow shop", to: "JB THREE BOARDERS MALL", distance: 0.45 },
      { from: "yellow shop", to: "Luangwa Indeco", distance: 0.45 },
      { from: "yellow shop", to: "Luangwa main sda churh", distance: 0.70 },
      { from: "Luangwa main sda churh", to: "Zambia Electricity Supply Corporation", distance: 0.65 },
      { from: "Luangwa District Hospital", to: "Zambia Electricity Supply Corporation", distance: 2.8 },
      { from: "Luangwa Feira Day Secondary School", to: "Big 2 Zambezi Water Front Resort & Safari", distance: 4.0 },
      { from: "Luangwa Feira Day Secondary School", to: "Katondwe Mission Hospital", distance: 48 },
      { from: "Katondwe Mission Hospital", to: "Mwavi Secondary School", distance: 7.2 },
      { from: "Mwavi Secondary School", to: "Luangwa Bridge Market", distance: 27.3 },
      { from: "Mwavi Secondary School", to: "Chitope", distance: 1.1 },
      { from: "Chitope", to: "Luangwa Secondary School", distance: 14 },
      { from: "Luangwa Bridge Market", to: "Luangwa Bridge", distance: 12.7 }
    ];

    function buildGraph(segments) {
      const graph = {};
      segments.forEach(seg => {
        if (!graph[seg.from]) graph[seg.from] = [];
        if (!graph[seg.to]) graph[seg.to] = [];
        graph[seg.from].push({ place: seg.to, distance: seg.distance });
        graph[seg.to].push({ place: seg.from, distance: seg.distance });
      });
      return graph;
    }

    function findShortestDistance(from, to, segments) {
      const graph = buildGraph(segments);
      if (!graph[from] || !graph[to]) return null;
      const distances = {};
      const visited = new Set();
      places.forEach(place => distances[place] = Infinity);
      distances[from] = 0;
      let queue = [{ place: from, dist: 0 }];
      while (queue.length > 0) {
        queue.sort((a, b) => a.dist - b.dist);
        const { place, dist } = queue.shift();
        if (place === to) return dist;
        if (visited.has(place)) continue;
        visited.add(place);
        for (let neighbor of (graph[place] || [])) {
          if (dist + neighbor.distance < distances[neighbor.place]) {
            distances[neighbor.place] = dist + neighbor.distance;
            queue.push({ place: neighbor.place, dist: distances[neighbor.place] });
          }
        }
      }
      return null;
    }

    // Populate select dropdowns for from/to
    function populateTaxiPlacesSelect() {
      const fromSel = document.getElementById('taxiHireFrom');
      const toSel = document.getElementById('taxiHireTo');
      fromSel.innerHTML = '<option value="">Select pickup location</option>';
      toSel.innerHTML = '<option value="">Select drop-off location</option>';
      places.forEach(place => {
        let opt1 = document.createElement('option');
        opt1.value = place;
        opt1.textContent = place;
        fromSel.appendChild(opt1);
        let opt2 = document.createElement('option');
        opt2.value = place;
        opt2.textContent = place;
        toSel.appendChild(opt2);
      });
    }
    populateTaxiPlacesSelect();

    // Taxi hire modal logic
    const taxiCard = document.getElementById('taxiCard');
    const taxiHireModal = document.getElementById('taxiHireModal');
    const taxiHireModalClose = document.getElementById('taxiHireModalClose');
    const taxiCalcBtn = document.getElementById('taxiCalcBtn');
    const taxiSmsBtn = document.getElementById('taxiSmsBtn');
    const taxiWhatsappBtn = document.getElementById('taxiWhatsappBtn');
    const taxiShowMapBtn = document.getElementById('taxiShowMapBtn');
    const taxiHideMapBtn = document.getElementById('taxiHideMapBtn');
    const taxiHireMap = document.getElementById('taxiHireMap');
    const taxiHireMapIframe = document.getElementById('taxiHireMapIframe');
    const taxiHireStatus = document.getElementById('taxiHireStatus');

    taxiCard.onclick = () => {
      taxiHireModal.classList.add("show");
      taxiHireMap.classList.remove("show");
      taxiShowMapBtn.style.display = "";
      taxiHideMapBtn.style.display = "none";
      taxiHireStatus.textContent = '';
      document.getElementById('taxiPhoneModal').value = '';
      document.getElementById('taxiHireFrom').selectedIndex = 0;
      document.getElementById('taxiHireTo').selectedIndex = 0;
      document.querySelector('input[name="taxiHireMode"][value="vehicle"]').checked = true;
      taxiHireMapIframe.src = 'https://www.google.com/maps?q=Luangwa&output=embed';
    };

    taxiHireModalClose.onclick = () => { taxiHireModal.classList.remove("show"); };

    window.addEventListener('keydown', function(e) {
      if (e.key === "Escape" && taxiHireModal.classList.contains("show")) {
        taxiHireModal.classList.remove("show");
      }
      if (e.key === "Escape" && detailsModal.classList.contains("show")) {
        detailsModal.classList.remove("show");
      }
    });

    taxiHireModal.addEventListener('mousedown', function(e) {
      if (e.target === taxiHireModal) taxiHireModal.classList.remove("show");
    });

    taxiShowMapBtn.onclick = () => {
      const from = document.getElementById('taxiHireFrom').value;
      const to = document.getElementById('taxiHireTo').value;
      if (!from || !to) {
        taxiHireStatus.textContent = "Please select both pickup and drop-off locations to view the map.";
        taxiHireStatus.className = "taxi-hire-status error";
        return;
      }
      const embedUrl = `https://www.google.com/maps?q=${encodeURIComponent(from + ' to ' + to)}&output=embed`;
      taxiHireMapIframe.src = embedUrl;
      taxiHireMap.classList.add("show");
      taxiShowMapBtn.style.display = "none";
      taxiHideMapBtn.style.display = "";
    };

    taxiHideMapBtn.onclick = () => {
      taxiHireMap.classList.remove("show");
      taxiShowMapBtn.style.display = "";
      taxiHideMapBtn.style.display = "none";
    };

    function getSelectedTaxiMode() {
      const radios = document.getElementsByName('taxiHireMode');
      for (let radio of radios) if (radio.checked) return radio.value;
      return "vehicle";
    }

    taxiCalcBtn.onclick = () => {
      const from = document.getElementById('taxiHireFrom').value;
      const to = document.getElementById('taxiHireTo').value;
      const mode = getSelectedTaxiMode();
      if (!from || !to) {
        taxiHireStatus.textContent = "Please select both pickup and drop-off locations.";
        taxiHireStatus.className = "taxi-hire-status error";
        return;
      }
      let dist = findShortestDistance(from, to, segments);
      if (dist === null) {
        taxiHireStatus.textContent = "No known route between selected places.";
        taxiHireStatus.className = "taxi-hire-status error";
        return;
      }
      let cost = mode === "motorbike" ? Math.ceil(dist / 3) * 10 : Math.ceil(dist / 3) * 20;
      taxiHireStatus.textContent = `Distance: ${dist.toFixed(2)} km. Fare: ZK ${cost} (${mode === 'vehicle' ? 'Vehicle' : 'Motorbike'})`;
      taxiHireStatus.className = "taxi-hire-status success";
    };

    function validateTaxiInputs() {
      const phone = document.getElementById('taxiPhoneModal').value.trim();
      const from = document.getElementById('taxiHireFrom').value;
      const to = document.getElementById('taxiHireTo').value;
      if (!phone || !/^\d{10}$/.test(phone)) {
        taxiHireStatus.textContent = "Please enter a valid 10-digit phone number.";
        taxiHireStatus.className = "taxi-hire-status error";
        return false;
      }
      if (!from || !to) {
        taxiHireStatus.textContent = "Please select both pickup and drop-off locations.";
        taxiHireStatus.className = "taxi-hire-status error";
        return false;
      }
      if (from === to) {
        taxiHireStatus.textContent = "Pickup and drop-off locations cannot be the same.";
        taxiHireStatus.className = "taxi-hire-status error";
        return false;
      }
      return { phone, from, to };
    }

    taxiSmsBtn.onclick = () => {
      const inputs = validateTaxiInputs();
      if (!inputs) return;
      const { phone, from, to } = inputs;
      const mode = getSelectedTaxiMode();
      let dist = findShortestDistance(from, to, segments);
      let cost = (dist === null) ? "N/A" : (mode === "motorbike" ? Math.ceil(dist / 3) * 10 : Math.ceil(dist / 3) * 20);
      const msg = `Taxi Booking:\nMode: ${mode}\nFrom: ${from}\nTo: ${to}\nCustomer: ${phone}\nDistance: ${dist !== null ? dist.toFixed(2) : "N/A"} km\nFare: ZK ${cost}`;
      window.open(`sms:+260978167546?body=${encodeURIComponent(msg)}`, "_blank");
      taxiHireStatus.textContent = "Booking sent via SMS!";
      taxiHireStatus.className = "taxi-hire-status success";
    };

    taxiWhatsappBtn.onclick = () => {
      const inputs = validateTaxiInputs();
      if (!inputs) return;
      const { phone, from, to } = inputs;
      const mode = getSelectedTaxiMode();
      let dist = findShortestDistance(from, to, segments);
      let cost = (dist === null) ? "N/A" : (mode === "motorbike" ? Math.ceil(dist / 3) * 10 : Math.ceil(dist / 3) * 20);
      const msg = `Taxi Booking:\nMode: ${mode}\nFrom: ${from}\nTo: ${to}\nCustomer: ${phone}\nDistance: ${dist !== null ? dist.toFixed(2) : "N/A"} km\nFare: ZK ${cost}`;
      window.open(`https://wa.me/+260978167546?text=${encodeURIComponent(msg)}`, "_blank");
      taxiHireStatus.textContent = "Booking sent via WhatsApp!";
      taxiHireStatus.className = "taxi-hire-status success";
    };

    // --- Masampo Section ---
    const masampoItems = [
      {
        id: 1,
        name: "Toyota Corolla",
        location: "Luangwa (Feira)",
        price: 15000,
        images: [
          "https://via.placeholder.com/120x82?text=Corolla1",
          "https://via.placeholder.com/120x82?text=Corolla2",
          "https://via.placeholder.com/120x82?text=Corolla3"
        ],
        description: "2018 model, excellent condition, available for bidding.",
        contact: "+260978167546"
      },
      {
        id: 2,
        name: "Honda CR-V",
        location: "Katondwe Mission Hospital",
        price: 22000,
        images: [
          "https://via.placeholder.com/120x82?text=CR-V1",
          "https://via.placeholder.com/120x82?text=CR-V2"
        ],
        description: "2020 model, low mileage, ready for immediate sale.",
        contact: "+260978167546"
      }
    ];

    function populateMasampoSection() {
      const track = document.getElementById('masampo-slider-track');
      track.innerHTML = '';
      masampoItems.forEach(item => {
        const card = document.createElement('div');
        card.className = 'vehicle-item';
        card.innerHTML = `
          <img src="${item.images[0]}" alt="${item.name}">
          <h4>${item.name}</h4>
          <p class="location">${item.location}</p>
          <p>ZK ${item.price.toLocaleString()}</p>
          <button onclick="showDetailsModal('masampo', ${item.id})">View Details</button>
        `;
        track.appendChild(card);
      });
    }
    populateMasampoSection();

    // --- B-istore Section ---
    const bistoreItems = [
      { id: 1, name: "Mosi Beer", price: 25, image: "M.jpeg", category: "beverages" },
      { id: 2, name: "Castle Lager", price: 24, image: "CC.jpeg", category: "beverages" },
      { id: 3, name: "Castle Light Dumpy", price: 25, image: "CLD.jpeg", category: "beverages" },
      { id: 4, name: "Black Label", price: 20, image: "BL.webp", category: "beverages" },
      { id: 5, name: "Coca-Cola bottled", price: 12, image: "MC.jpg", category: "beverages" },
      { id: 6, name: "Fanta", price: 12, image: "F.jpeg", category: "beverages" },
      { id: 7, name: "Disposable Fanta", price: 15, image: "DD.jpg", category: "beverages" },
      { id: 8, name: "Disposable Coke", price: 15, image: "DD.jpg", category: "beverages" },
      { id: 9, name: "Disposable Sprite", price: 15, image: "DD.jpg", category: "beverages" },
      { id: 10, name: "Fresh_Up", price: 15.9, image: "Freshup.png", category: "beverages" },
      { id: 11, name: "Black Label Cained", price: 30, image: "BL.webp", category: "beverages" },
      { id: 12, name: "Fruitcana", price: 15, image: "Fruitc.webp", category: "beverages" },
      { id: 13, name: "Kunfu", price: 15, image: "Konfu.png", category: "beverages" },
      { id: 14, name: "Mojo", price: 15, image: "Mojo.png", category: "beverages" },
      { id: 15, name: "Red Rock", price: 15, image: "RR.png", category: "beverages" },
      { id: 16, name: "Rasta", price: 15, image: "Rasta.png", category: "beverages" },
      { id: 17, name: "Life Shots", price: 15, image: "Shots.webp", category: "beverages" },
      { id: 18, name: "Fruitcana Red Smoothie", price: 15, image: "Smoothy.png", category: "beverages" },
      { id: 19, name: "Sun Dance", price: 15, image: "Sund.png", category: "beverages" },
      { id: 20, name: "Tonic Water Brothers", price: 15, image: "Tonic.png", category: "beverages" },
      { id: 21, name: "Vatra", price: 15, image: "Vatra.png", category: "beverages" },
      { id: 22, name: "Wild Cat", price: 15, image: "Wildcat.png", category: "beverages" },
      { id: 23, name: "Fruit-up", price: 15, image: "Fruitup.png", category: "beverages" },
      { id: 24, name: "DP", price: 0, image: "D1.jpeg", category: "beverages" },
      { id: 25, name: "DP", price: 0, image: "D2.png", category: "beverages" },
      { id: 26, name: "DP", price: 0, image: "D3.jpeg", category: "beverages" },
      { id: 27, name: "DP", price: 0, image: "D4.jpeg", category: "beverages" },
      { id: 28, name: "DP", price: 0, image: "D5.jpeg", category: "beverages" },
      { id: 29, name: "DP", price: 0, image: "D6.jpeg", category: "beverages" },
      { id: 30, name: "DP", price: 0, image: "D7.jpeg", category: "beverages" },
      { id: 31, name: "DP", price: 0, image: "D8.jpeg", category: "beverages" },
      { id: 32, name: "o1", price: 0, image: "O1.jpeg", category: "beverages" },
      { id: 33, name: "o2", price: 0, image: "O2.jpeg", category: "beverages" },
      { id: 34, name: "o3", price: 0, image: "O3.jpeg", category: "beverages" },
      { id: 35, name: "o4", price: 0, image: "O4.jpg", category: "beverages" },
      { id: 36, name: "o5", price: 0, image: "O5.jpeg", category: "beverages" },
      { id: 37, name: "o6", price: 0, image: "O6.jpeg", category: "beverages" },
      { id: 38, name: "o7", price: 0, image: "O7.jpeg", category: "beverages" },
      { id: 39, name: "o8", price: 0, image: "O8.jpg", category: "beverages" },
      { id: 40, name: "o9", price: 0, image: "O9.jpeg", category: "beverages" },
      { id: 41, name: "10", price: 0, image: "010.jpeg", category: "beverages" },
      { id: 42, name: "11", price: 0, image: "O11.png", category: "beverages" },
      { id: 43, name: "12", price: 0, image: "012.jpeg", category: "beverages" },
      { id: 44, name: "13", price: 0, image: "O13.jpeg", category: "beverages" },
      { id: 45, name: "N1", price: 0, image: "N1.jpg", category: "beverages" },
      { id: 46, name: "N2", price: 0, image: "N2.jpeg", category: "beverages" },
      { id: 47, name: "N3", price: 0, image: "N3.jpeg", category: "beverages" },
      { id: 48, name: "N4", price: 0, image: "N4.jpeg", category: "beverages" },
      { id: 49, name: "N5", price: 0, image: "N5.jpeg", category: "beverages" },
      { id: 50, name: "N6", price: 0, image: "N6.jpeg", category: "beverages" },
      { id: 51, name: "N7", price: 0, image: "N7.jpeg", category: "beverages" },
      { id: 52, name: "N8", price: 0, image: "N8.jpeg", category: "beverages" },
      { id: 53, name: "N9", price: 0, image: "N9.jpeg", category: "beverages" },
      { id: 54, name: "N10", price: 0, image: "N10.jpeg", category: "beverages" },
      { id: 55, name: "N11", price: 0, image: "N11.jpeg", category: "beverages" },
      { id: 56, name: "N12", price: 0, image: "N12.jpeg", category: "beverages" },
      { id: 57, name: "N13", price: 0, image: "N13.jpeg", category: "beverages" },
      { id: 58, name: "N14", price: 0, image: "N14.jpeg", category: "beverages" },
      { id: 59, name: "N15", price: 0, image: "N15.jpeg", category: "beverages" },
      { id: 60, name: "N16", price: 0, image: "N16.jpeg", category: "beverages" },
      { id: 61, name: "N17", price: 0, image: "N17.jpeg", category: "beverages" },
      { id: 62, name: "N18", price: 0, image: "N18.jpeg", category: "beverages" },
      { id: 63, name: "N18", price: 0, image: "N18.jpeg", category: "beverages" },
      { id: 64, name: "N19", price: 0, image: "N19.jpeg", category: "beverages" },
      { id: 65, name: "N20", price: 0, image: "N20.jpeg", category: "beverages" },
      { id: 66, name: "N21", price: 0, image: "N21.jpeg", category: "beverages" },
      { id: 67, name: "N22", price: 0, image: "N22.jpeg", category: "beverages" },
      { id: 68, name: "N23", price: 0, image: "N23.jpeg", category: "beverages" },
      { id: 69, name: "N24", price: 0, image: "N24.jpeg", category: "beverages" },
      { id: 70, name: "N25", price: 0, image: "N25.jpeg", category: "beverages" },
      { id: 71, name: "N26", price: 0, image: "N26.jpeg", category: "beverages" },
      { id: 72, name: "N27", price: 0, image: "N27.webp", category: "beverages" },
      { id: 73, name: "N28", price: 0, image: "N28.webp", category: "beverages" },
      { id: 74, name: "N29", price: 0, image: "N29.jpeg", category: "beverages" },
      { id: 75, name: "N30", price: 0, image: "N30.jpeg", category: "beverages" },
      { id: 76, name: "N31", price: 0, image: "N31.jpeg", category: "beverages" },
      { id: 77, name: "N32", price: 0, image: "N32.jpeg", category: "beverages" },
      { id: 78, name: "N33", price: 0, image: "N33.jpeg", category: "beverages" },
      { id: 79, name: "N34", price: 0, image: "N34.jpeg", category: "beverages" },
      { id: 80, name: "N35", price: 0, image: "N35.jpeg", category: "beverages" },
      { id: 81, name: "N36", price: 0, image: "N36.jpeg", category: "beverages" },
      { id: 82, name: "N37", price: 0, image: "N37.jpeg", category: "beverages" },
      { id: 83, name: "N38", price: 0, image: "N38.jpeg", category: "beverages" },
      { id: 84, name: "N39", price: 0, image: "N39.jpeg", category: "beverages" },
      { id: 85, name: "N40", price: 0, image: "N40.jpeg", category: "beverages" },
      { id: 86, name: "N41", price: 0, image: "N41.jpeg", category: "beverages" },
      { id: 87, name: "N42", price: 0, image: "N42.jpeg", category: "beverages" },
      { id: 88, name: "N43", price: 0, image: "N43.jpeg", category: "beverages" },
      { id: 89, name: "N44", price: 0, image: "N44.jpeg", category: "beverages" },
      { id: 90, name: "N45", price: 0, image: "N45.jpeg", category: "beverages" },
      { id: 91, name: "N46", price: 0, image: "N46.jpeg", category: "beverages" },
      { id: 92, name: "N47", price: 0, image: "N47.jpeg", category: "beverages" },
      { id: 93, name: "N48", price: 0, image: "N48.jpeg", category: "beverages" },
      { id: 94, name: "N49", price: 0, image: "N49.jpeg", category: "beverages" },
      { id: 95, name: "N50", price: 0, image: "N50.jpeg", category: "beverages" },
      { id: 96, name: "N51", price: 0, image: "N51.jpeg", category: "beverages" },
      { id: 97, name: "N52", price: 0, image: "N52.jpeg", category: "beverages" },
      { id: 98, name: "N53", price: 0, image: "N53.jpeg", category: "beverages" },
      { id: 99, name: "N54", price: 0, image: "N54.jpeg", category: "beverages" },
      { id: 100, name: "Calculator Casio GX-14", price: 230, image: "GX.jpg", category: "stationary" },
      { id: 101, name: "Big Clear Sellotape", price: 40, image: "sello.webp", category: "stationary" },
      { id: 102, name: "Blue Pen", price: 3, image: "pen2.png", category: "stationary" },
      { id: 103, name: "Red Pen", price: 3, image: "pen.png", category: "stationary" },
      { id: 104, name: "Blue Permanent Marker", price: 6, image: "makers.jpeg", category: "stationary" },
      { id: 105, name: "Red Permanent Maker", price: 6, image: "makers.jpeg", category: "stationary" },
      { id: 106, name: "Black Permanent Marker", price: 6, image: "makers.jpeg", category: "stationary" },
      { id: 107, name: "Green Permanent Marker", price: 6, image: "makers.jpeg", category: "stationary" },
      { id: 108, name: "A4 Brown Envelope", price: 3, image: "envelope.jpg", category: "stationary" },
      { id: 109, name: "Ball Stick n tack", price: 15, image: "tack.jpg", category: "stationary" },
      { id: 110, name: "Ream of Paper", price: 80, image: "ream.jpeg", category: "stationary" },
      { id: 111, name: "Stepler", price: 20, image: "stepp.jpg", category: "stationary" },
      { id: 112, name: "File folder A4", price: 15, image: "dfolder2.jpg", category: "stationary" },
      { id: 113, name: "Perforator Kangaro", price: 20, image: "perfo.jpg", category: "stationary" },
      { id: 114, name: "Ink Pad", price: 15, image: "inkpad.jpg", category: "stationary" },
      { id: 115, name: "Metal File Fastner ", price: 3, image: "ffast.webp", category: "stationary" },
      { id: 116, name: "Ruller 30cm", price: 10, image: "ruller.jpeg", category: "stationary" },
      { id: 117, name: "Disk Lock", price: 30, image: "lock.png", category: "general" },
      { id: 118, name: "KENKO Electronic Calculator", price: 200, image: "EC1.jpg", category: "stationary" },
      { id: 119, name: "Ream of Paper", price: 80, image: "ream2.png", category: "stationary" },
      { id: 120, name: "File folder A4", price: 15, image: "dfolder.jpg", category: "stationary" },
      { id: 121, name: "pencils", price: 3, image: "pencil.jpg", category: "stationary" },
      { id: 122, name: "Heavy Duty Steppler", price: 100, image: "stepp2.jpg", category: "stationary" },
      { id: 123, name: "Ruller 30cm", price: 10, image: "ruller2.jpg", category: "stationary" },
      { id: 200, name: "Black Label Big", price: 30, image: "BL.webp", category: "beverages" }
    ];

    function populateBistoreSection() {
      const track = document.getElementById('bistore-slider-track');
      track.innerHTML = '';
      bistoreItems.forEach(item => {
        const card = document.createElement('div');
        card.className = 'product';
        card.innerHTML = `
          <img src="${item.images[0]}" alt="${item.name}">
          <h4>${item.name}</h4>
          <p>ZK ${item.price.toLocaleString()}</p>
          ${item.stock > 0 ? '' : '<span class="out-stock">Out of stock</span>'}
          <button ${item.stock > 0 ? '' : 'disabled'} onclick="addToCart(${item.id})">Add to Cart</button>
        `;
        track.appendChild(card);
      });
    }
    populateBistoreSection();

    // --- Cart System ---
    let cart = [];

    function addToCart(productId) {
      const product = bistoreItems.find(p => p.id === productId);
      if (!product || product.stock === 0) return;
      const cartItem = cart.find(item => item.id === productId);
      if (cartItem) {
        if (cartItem.quantity < product.stock) {
          cartItem.quantity += 1;
        } else {
          showStatusMessage(`Cannot add more ${product.name}. Stock limit reached.`, 'error');
          return;
        }
      } else {
        cart.push({ id: productId, name: product.name, price: product.price, quantity: 1, image: product.images[0] });
      }
      updateCart();
      showStatusMessage(`${product.name} added to cart!`, 'success');
    }

    function updateCart() {
      const cartItems = document.getElementById('cart-items');
      const emptyCart = document.getElementById('empty-cart');
      const cartTotal = document.getElementById('cart-total');
      const checkoutActions = document.getElementById('checkoutActions');
      cartItems.innerHTML = '';
      if (cart.length === 0) {
        emptyCart.style.display = 'block';
        cartTotal.style.display = 'none';
        checkoutActions.style.display = 'none';
        return;
      }
      emptyCart.style.display = 'none';
      cartTotal.style.display = 'block';
      checkoutActions.style.display = 'flex';
      let total = 0;
      cart.forEach(item => {
        const product = bistoreItems.find(p => p.id === item.id);
        const li = document.createElement('li');
        li.innerHTML = `
          <div class="cart-item-info">
            <img src="${item.image}" class="cart-thumb" alt="${item.name}">
            <span class="cart-item-title">${item.name}</span>
          </div>
          <div class="cart-price-block">
            <span>ZK ${item.price}</span>
            <div class="quantity-controls">
              <button class="quantity-btn" onclick="updateQuantity(${item.id}, -1)">-</button>
              <input type="number" class="cart-item-qty" value="${item.quantity}" min="1" max="${product.stock}" onchange="updateQuantity(${item.id}, this.value)">
              <button class="quantity-btn" onclick="updateQuantity(${item.id}, 1)">+</button>
            </div>
            <button class="remove-btn" onclick="removeFromCart(${item.id})">&times;</button>
          </div>
        `;
        cartItems.appendChild(li);
        total += item.price * item.quantity;
      });
      document.getElementById('products-total').textContent = total.toFixed(2);
      document.getElementById('grand-total').textContent = total.toFixed(2);
    }

    function updateQuantity(productId, value) {
      const cartItem = cart.find(item => item.id === productId);
      const product = bistoreItems.find(p => p.id === productId);
      let newQuantity = typeof value === 'number' ? cartItem.quantity + value : parseInt(value);
      if (newQuantity < 1) newQuantity = 1;
      if (newQuantity > product.stock) {
        newQuantity = product.stock;
        showStatusMessage(`Cannot exceed stock limit of ${product.name}.`, 'error');
      }
      cartItem.quantity = newQuantity;
      updateCart();
    }

    function removeFromCart(productId) {
      cart = cart.filter(item => item.id !== productId);
      updateCart();
      showStatusMessage('Item removed from cart.', 'success');
    }

    function showStatusMessage(message, type) {
      const statusMessage = document.getElementById('statusMessage');
      statusMessage.textContent = message;
      statusMessage.className = `status-message ${type}`;
      setTimeout(() => { statusMessage.textContent = ''; statusMessage.className = 'status-message'; }, 3000);
    }

    document.getElementById('checkout-btn-sms').onclick = () => {
      if (cart.length === 0) {
        showStatusMessage('Your cart is empty. Add items to proceed.', 'error');
        return;
      }
      let message = 'Order Details:\n';
      let total = 0;
      cart.forEach(item => {
        message += `${item.name} - ZK ${item.price} x ${item.quantity}\n`;
        total += item.price * item.quantity;
      });
      message += `Total: ZK ${total.toFixed(2)}`;
      window.open(`sms:+260978167546?body=${encodeURIComponent(message)}`, "_blank");
      showStatusMessage('Order sent via SMS!', 'success');
    };

    document.getElementById('checkout-btn-whatsapp').onclick = () => {
      if (cart.length === 0) {
        showStatusMessage('Your cart is empty. Add items to proceed.', 'error');
        return;
      }
      let message = 'Order Details:\n';
      let total = 0;
      cart.forEach(item => {
        message += `${item.name} - ZK ${item.price} x ${item.quantity}\n`;
        total += item.price * item.quantity;
      });
      message += `Total: ZK ${total.toFixed(2)}`;
      window.open(`https://wa.me/+260978167546?text=${encodeURIComponent(message)}`, "_blank");
      showStatusMessage('Order sent via WhatsApp!', 'success');
    };

    // --- Details Modal ---
    const detailsModal = document.getElementById('detailsModal');
    const detailsModalClose = document.getElementById('detailsModalClose');
    const detailsModalTitle = document.getElementById('detailsModalTitle');
    const detailsModalImg = document.getElementById('detailsModalImg');
    const detailsModalImgs = document.getElementById('detailsModalImgs');
    const detailsModalArrows = document.getElementById('detailsModalArrows');
    const detailsModalPrevImg = document.getElementById('detailsModalPrevImg');
    const detailsModalNextImg = document.getElementById('detailsModalNextImg');
    const detailsModalDetails = document.getElementById('detailsModalDetails');
    const masampoBidBlock = document.getElementById('masampoBidBlock');
    const masampoBidDestLabel = document.getElementById('masampoBidDestLabel');
    const masampoBidValue = document.getElementById('masampoBidValue');
    const masampoBidPhone = document.getElementById('masampoBidPhone');
    const masampoBidSms = document.getElementById('masampoBidSms');
    const masampoBidWhatsapp = document.getElementById('masampoBidWhatsapp');
    const masampoBidStatus = document.getElementById('masampoBidStatus');

    function showDetailsModal(type, id) {
      const item = type === 'masampo' ? masampoItems.find(i => i.id === id) : bistoreItems.find(i => i.id === id);
      if (!item) return;
      detailsModalTitle.textContent = item.name;
      detailsModalImg.src = item.images[0];
      detailsModalImg.alt = item.name;
      detailsModalImgs.innerHTML = item.images.map((img, index) => `
        <img src="${img}" alt="${item.name} ${index + 1}" class="${index === 0 ? 'selected' : ''}" onclick="changeModalImage(${index}, ${JSON.stringify(item.images)})">
      `).join('');
      detailsModalDetails.textContent = item.description;
      detailsModalArrows.style.display = item.images.length > 1 ? 'flex' : 'none';
      detailsModalPrevImg.disabled = true;
      detailsModalNextImg.disabled = item.images.length <= 1;
      let currentImageIndex = 0;

      detailsModalPrevImg.onclick = () => {
        if (currentImageIndex > 0) {
          currentImageIndex--;
          detailsModalImg.src = item.images[currentImageIndex];
          updateModalImageSelection(currentImageIndex);
          detailsModalPrevImg.disabled = currentImageIndex === 0;
          detailsModalNextImg.disabled = false;
        }
      };

      detailsModalNextImg.onclick = () => {
        if (currentImageIndex < item.images.length - 1) {
          currentImageIndex++;
          detailsModalImg.src = item.images[currentImageIndex];
          updateModalImageSelection(currentImageIndex);
          detailsModalNextImg.disabled = currentImageIndex === item.images.length - 1;
          detailsModalPrevImg.disabled = false;
        }
      };

      if (type === 'masampo') {
        masampoBidBlock.style.display = 'block';
        masampoBidDestLabel.textContent = item.contact;
        masampoBidValue.value = '';
        masampoBidPhone.value = '';
        masampoBidStatus.textContent = '';
      } else {
        masampoBidBlock.style.display = 'none';
      }

      detailsModal.classList.add('show');
    }

    function changeModalImage(index, images) {
      detailsModalImg.src = images[index];
      updateModalImageSelection(index);
      detailsModalPrevImg.disabled = index === 0;
      detailsModalNextImg.disabled = index === images.length - 1;
    }

    function updateModalImageSelection(index) {
      const thumbs = detailsModalImgs.querySelectorAll('img');
      thumbs.forEach((thumb, i) => {
        thumb.classList.toggle('selected', i === index);
      });
    }

    detailsModalClose.onclick = () => { detailsModal.classList.remove('show'); };
    detailsModal.addEventListener('mousedown', function(e) {
      if (e.target === detailsModal) detailsModal.classList.remove('show');
    });

    function validateBidInputs() {
      const bidValue = masampoBidValue.value.trim();
      const phone = masampoBidPhone.value.trim();
      if (!bidValue || isNaN(bidValue) || bidValue <= 0) {
        masampoBidStatus.textContent = 'Please enter a valid bid value.';
        masampoBidStatus.className = 'bid-status error';
        return false;
      }
      if (!phone || !/^\d{10}$/.test(phone)) {
        masampoBidStatus.textContent = 'Please enter a valid 10-digit phone number.';
        masampoBidStatus.className = 'bid-status error';
        return false;
      }
      return { bidValue, phone };
    }

    masampoBidSms.onclick = () => {
      const inputs = validateBidInputs();
      if (!inputs) return;
      const { bidValue, phone } = inputs;
      const item = masampoItems.find(i => i.name === detailsModalTitle.textContent);
      const message = `Bid for ${item.name}:\nBid Value: ZK ${bidValue}\nCustomer Phone: ${phone}\nLocation: ${item.location}`;
      window.open(`sms:${item.contact}?body=${encodeURIComponent(message)}`, "_blank");
      masampoBidStatus.textContent = 'Bid sent via SMS!';
      masampoBidStatus.className = 'bid-status success';
    };

    masampoBidWhatsapp.onclick = () => {
      const inputs = validateBidInputs();
      if (!inputs) return;
      const { bidValue, phone } = inputs;
      const item = masampoItems.find(i => i.name === detailsModalTitle.textContent);
      const message = `Bid for ${item.name}:\nBid Value: ZK ${bidValue}\nCustomer Phone: ${phone}\nLocation: ${item.location}`;
      window.open(`https://wa.me/${item.contact}?text=${encodeURIComponent(message)}`, "_blank");
      masampoBidStatus.textContent = 'Bid sent via WhatsApp!';
      masampoBidStatus.className = 'bid-status success';
    };

    // --- Slider Navigation ---
    function setupSlider(sectionId, prevBtnId, nextBtnId, trackId) {
      const prevBtn = document.getElementById(prevBtnId);
      const nextBtn = document.getElementById(nextBtnId);
      const track = document.getElementById(trackId);

      function updateButtons() {
        const scrollLeft = track.scrollLeft;
        const maxScroll = track.scrollWidth - track.clientWidth;
        prevBtn.disabled = scrollLeft <= 0;
        nextBtn.disabled = scrollLeft >= maxScroll - 1;
      }

      prevBtn.onclick = () => {
        track.scrollBy({ left: -270, behavior: 'smooth' });
        setTimeout(updateButtons, 300);
      };

      nextBtn.onclick = () => {
        track.scrollBy({ left: 270, behavior: 'smooth' });
        setTimeout(updateButtons, 300);
      };

      track.addEventListener('scroll', updateButtons);
      updateButtons();
    }

    setupSlider('taxiSliderSection', 'prevTaxiBtn', 'nextTaxiBtn', 'taxi-slider-track');
    setupSlider('masampoSliderSection', 'prevMasampoBtn', 'nextMasampoBtn', 'masampo-slider-track');
    setupSlider('bistoreSliderSection', 'prevBistoreBtn', 'nextBistoreBtn', 'bistore-slider-track');

    // --- Filter and Search ---
    const categoryFilter = document.getElementById('categoryFilter');
    const searchBox = document.getElementById('searchBox');

    function filterSections() {
      const category = categoryFilter.value;
      const search = searchBox.value.toLowerCase();
      const sections = {
        'all': ['taxiSliderSection', 'masampoSliderSection', 'bistoreSliderSection'],
        'taxi': ['taxiSliderSection'],
        'masampo': ['masampoSliderSection'],
        'bistore': ['bistoreSliderSection']
      };

      document.getElementById('taxiSliderSection').style.display = sections[category].includes('taxiSliderSection') ? 'block' : 'none';
      document.getElementById('masampoSliderSection').style.display = sections[category].includes('masampoSliderSection') ? 'block' : 'none';
      document.getElementById('bistoreSliderSection').style.display = sections[category].includes('bistoreSliderSection') ? 'block' : 'none';

      const masampoTrack = document.getElementById('masampo-slider-track');
      masampoTrack.innerHTML = '';
      masampoItems
        .filter(item => item.name.toLowerCase().includes(search) || item.location.toLowerCase().includes(search))
        .forEach(item => {
          const card = document.createElement('div');
          card.className = 'vehicle-item';
          card.innerHTML = `
            <img src="${item.images[0]}" alt="${item.name}">
            <h4>${item.name}</h4>
            <p class="location">${item.location}</p>
            <p>ZK ${item.price.toLocaleString()}</p>
            <button onclick="showDetailsModal('masampo', ${item.id})">View Details</button>
          `;
          masampoTrack.appendChild(card);
        });

      const bistoreTrack = document.getElementById('bistore-slider-track');
      bistoreTrack.innerHTML = '';
      bistoreItems
        .filter(item => item.name.toLowerCase().includes(search) || item.description.toLowerCase().includes(search))
        .forEach(item => {
          const card = document.createElement('div');
          card.className = 'product';
          card.innerHTML = `
            <img src="${item.images[0]}" alt="${item.name}">
            <h4>${item.name}</h4>
            <p>ZK ${item.price.toLocaleString()}</p>
            ${item.stock > 0 ? '' : '<span class="out-stock">Out of stock</span>'}
            <button ${item.stock > 0 ? '' : 'disabled'} onclick="addToCart(${item.id})">Add to Cart</button>
          `;
          bistoreTrack.appendChild(card);
        });

      setupSlider('masampoSliderSection', 'prevMasampoBtn', 'nextMasampoBtn', 'masampo-slider-track');
      setupSlider('bistoreSliderSection', 'prevBistoreBtn', 'nextBistoreBtn', 'bistore-slider-track');
    }

    categoryFilter.onchange = filterSections;
    searchBox.oninput = filterSections;
  </script>
</body>
</html>
