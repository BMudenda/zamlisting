<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ZamListing</title>
  <link rel="icon" href="/favicon.ico" type="image/x-icon"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"/>
  <style>
    :root {
      --primary: #2e7d32; --primary-dark: #1b5e20; --primary-light: #81c784; --accent: #ff9800;
      --text: #222; --text-light: #666; --background: #f5f5f5; --card-bg: white;
      --border: #e0e0e0; --shadow: 0 0 8px rgba(0,0,0,0.05); --success: #e8f5e9;
      --error: #ffebee; --toast-success: #43a047; --toast-error: #c62828; --danger: #c62828;
      --whatsapp: #25D366; --sms: #2196F3;
      --footer-bg: #2e7d32;
      --footer-text: #fff;
      --footer-link: #ffd600;
    }
    body { font-family: 'Roboto', sans-serif; color: var(--text); background: var(--background); line-height: 1.5; }
    .brand-title { font-size: 2.6rem; font-weight: 900; letter-spacing: 0.05em; color: var(--primary-dark); text-shadow: 0 1px 0 #fff; margin-bottom: 0.6rem; }
    .brand-title .highlight { color: var(--accent); text-shadow: none; }
    .tagline { font-size: 1.45rem; font-weight: 500; color: var(--primary); margin-bottom: 0.45rem; }
    .subtitle { font-size: 1.1rem; color: var(--text-light); margin-bottom: 1.2rem; margin-top: -0.5rem; }
    header { background: linear-gradient(135deg, var(--primary), var(--primary-dark) 90%); color: white; padding: 2.2rem 1rem 1.5rem 1rem; text-align: center; box-shadow: 0 2px 7px rgba(0,0,0,0.09); border-radius: 0 0 18px 18px; margin-bottom: 1.4rem; }
    .container { max-width: 1200px; margin: 2rem auto; padding: 0 1rem; display: flex; flex-direction: column; gap: 2rem; }
    .filter-search-section { width: 100%; margin-bottom: 1.5rem; }
    .filter-search-section > div { display: flex; gap: 1rem; align-items: center; flex-wrap: wrap; }
    .filter-search-section label { font-weight: 500; }
    .filter-search-section select, .filter-search-section input[type="text"] {
      padding: 0.5rem; border-radius: 4px; border: 1px solid #ccc; font-size: 1.06rem; min-width: 120px;
    }
    .slider-section { position: relative; width: 100%; margin-bottom: 2rem; background: var(--card-bg); border-radius: 12px; box-shadow: var(--shadow); padding: 1.5rem 1rem 1rem; }
    .slider-title { display: flex; align-items: center; gap: 0.7rem; font-size: 1.42rem; margin-bottom: 1.1rem; color: var(--primary-dark); font-weight: 600; }
    .slider-track { display: flex; overflow-x: auto; gap: 1.4rem; scroll-behavior: smooth; padding-bottom: 16px; padding-top: 6px; }
    .slider-btn { position: absolute; top: 50%; transform: translateY(-50%); background: rgba(0,0,0,0.63); border: none; color: white; width: 38px; height: 38px; border-radius: 50%; font-size: 1.3rem; cursor: pointer; z-index: 2; transition: background 0.2s; box-shadow: 0 2px 8px rgba(0,0,0,0.09); }
    .slider-btn:hover { background: rgba(0,0,0,0.81); }
    .slider-btn.prev { left: 8px; }
    .slider-btn.next { right: 8px; }
    .slider-section[hidden] { display: none !important; }
    /* Taxi Hire Card */
    .taxi-card { min-width: 250px; max-width: 270px; margin: 0 auto; background: linear-gradient(120deg, #e0f7fa 60%, #fceabb 100%); border-radius: 15px; box-shadow: 0 2px 22px rgba(0,0,0,0.12); padding: 0.6rem 1.2rem 1.2rem 1.2rem; display: flex; flex-direction: column; align-items: center; gap: 0.8rem; position: relative; cursor: pointer; transition: box-shadow 0.2s, transform 0.2s; }
    .taxi-card:hover { box-shadow: 0 7px 26px rgba(0,0,0,0.15); transform: scale(1.04);}
    .taxi-emoji-animated { width: 100%; display: flex; align-items: center; justify-content: center; gap: 0.7rem; font-size: 2.9rem; margin: 0.7rem 0 0.3rem 0; animation: taxiEmojiBounce 1.4s infinite ease-in-out;}
    @keyframes taxiEmojiBounce { 0% { transform: translateY(0); } 50% { transform: translateY(-10px) scale(1.07); } 100% { transform: translateY(0); } }
    .taxi-card-title { font-size: 1.17rem; font-weight: 600; color: var(--primary-dark); display: flex; align-items: center; gap: 0.4rem; justify-content: center; margin-bottom: 0.15rem; }
    .taxi-card-desc { color: var(--text-light); font-size: 1.01rem; text-align: center; margin-bottom: 0.2rem; }
    .product, .vehicle-item { min-width: 160px; max-width: 170px; border: 1px solid var(--border); border-radius: 10px; padding: 1rem 0.7rem; text-align: center; background: var(--card-bg); transition: transform 0.2s, box-shadow 0.2s; cursor: pointer; box-shadow: 0 2px 8px rgba(0,0,0,0.06); position: relative; display: flex; flex-direction: column; align-items: center; gap: 0.3rem; }
    .product:hover, .vehicle-item:hover { transform: translateY(-7px) scale(1.04); box-shadow: 0 7px 26px rgba(0,0,0,0.15);}
    .product img, .vehicle-item img { width: 82px; height: 82px; object-fit: cover; margin-bottom: 0.5rem; border-radius: 4px; border: 1px solid #eee; }
    .product h4, .vehicle-item h4 { font-size: 1rem; margin-bottom: 0.2rem; color: var(--text); }
    .product p, .vehicle-item p { color: var(--primary-dark); font-weight: 600; margin-bottom: 0.6rem; }
    .vehicle-item p.location { font-size: 0.9rem; color: var(--text-light); margin-bottom: 0.2rem;}
    .product .out-stock { display: block; color: #b71c1c; font-size: 0.97em; font-weight: 600; margin-bottom: 0.7em; }
    .product button { border: none; background: var(--primary); color: white; padding: 0.4rem 0.8rem; border-radius: 5px; cursor: pointer; font-family: inherit; font-weight: 500; transition: background 0.2s; font-size: 0.98em;}
    .product button:disabled { background: #ccc !important; cursor: not-allowed; }
    .cart { border: 1px solid var(--border); padding: 1.7rem 1.3rem 2.1rem; border-radius: 10px; flex: 1; min-width: 300px; background: var(--card-bg); position: sticky; top: 1rem; box-shadow: var(--shadow); }
    .cart-items { list-style: none; padding: 0; margin: 0 0 1.5rem; max-height: 320px; overflow-y: auto; }
    .cart-items li { padding: 0.8rem 0; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; gap: 0.2em; animation: fadein 0.33s; min-height: 54px; }
    .cart-items li:last-child { border-bottom: none; }
    .cart-thumb { width: 36px; height: 36px; object-fit: cover; border-radius: 4px; margin-right: 8px; vertical-align: middle; border: 1.5px solid #e5e7eb; }
    .cart-item-info { display: flex; align-items: center; flex: 1; min-width: 0; }
    .cart-item-title { font-weight: 500; font-size: 1.04em; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .cart-item-qty { width: 44px; font-size: 1em; margin: 0 6px; padding: 2px 6px; border-radius: 4px; border: 1px solid #ddd; text-align: center; }
    .cart-price-block { display: flex; align-items: center; gap: 4px; }
    .quantity-controls { display: flex; align-items: center; gap: 2px; }
    .quantity-btn, .remove-btn { border: none; background: none; color: var(--primary-dark); font-size: 1.1em; margin: 0 2px; cursor: pointer; padding: 2px 6px; border-radius: 4px; transition: background 0.2s; }
    .quantity-btn:active, .remove-btn:active { background: #f1f1f1; }
    .remove-btn { color: var(--danger); }
    .cart-total { margin: 1rem 0; padding-top: 1rem; border-top: 1px solid var(--border); }
    .cart-total p { margin: 0.5rem 0; }
    /* Hide default scrollbars for slider-tracks for better look */
    .slider-track::-webkit-scrollbar { height: 0px; background: transparent;}
    .slider-track { scrollbar-width: none; }
    .slider-track { -ms-overflow-style: none; }
    .slider-track::-webkit-scrollbar-thumb { background: transparent; }
    /* Taxi Hire Modal Styles */
    .modal { display: none; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
      background: rgba(0,0,0,0.52); z-index: 2000; align-items: center; justify-content: center; animation: fadein 0.3s;}
    .modal-content { background: #fff; border-radius: 13px; padding: 1.3rem 1.2rem; max-width: 99vw; width: 350px; box-shadow: 0 0 22px rgba(0,0,0,0.13); position: relative; display: flex; flex-direction: column; gap: 0.8rem; align-items: center;}
    .modal-close { position: absolute; top: 11px; right: 13px; font-size: 1.4rem; color: var(--danger); background: none; border: none; cursor: pointer; z-index: 1; transition: color 0.2s;}
    .modal-close:hover { color: var(--primary-dark);}
    .modal-title { font-size: 1.19rem; font-weight: 600; color: var(--primary-dark); margin-bottom: 0.3rem; text-align: center;}
    .modal-img { width: 150px; height: 150px; object-fit: cover; border-radius: 9px; margin-bottom: 0.5rem; border: 1.5px solid #eee;}
    .modal-details { font-size: 1.07rem; color: var(--text-light); text-align: left; width: 100%; margin-bottom: 0.2rem;}
    .modal-imgs { display: flex; align-items: center; gap: 10px; margin-bottom: 0.3rem;}
    .modal-imgs img { width: 50px; height: 50px; object-fit: cover; border-radius: 4px; border: 1px solid #ddd; cursor: pointer; transition: box-shadow 0.15s;}
    .modal-imgs img.selected { box-shadow: 0 0 0 3px var(--primary-light); }
    .modal-slider-arrows { display: flex; gap: 8px; align-items: center; margin-bottom: 0.3rem; margin-top: 0.1rem;}
    .modal-slider-arrow { background: var(--primary-light); border: none; border-radius: 50%; width: 32px; height: 32px; font-size: 1.2rem; cursor: pointer; color: #fff; transition: background 0.18s;}
    .modal-slider-arrow:disabled { background: #ddd; color: #aaa; cursor: not-allowed;}
    .taxi-hire-actions { display: flex; gap: 12px; align-items: center; justify-content: center; margin: 0.8rem 0 0.2rem 0;}
    .taxi-hire-btn { border: none; border-radius: 50%; width: 42px; height: 42px; font-size: 1.3rem; display: flex; align-items: center; justify-content: center; cursor: pointer; background: var(--primary-light); color: var(--primary-dark); transition: background 0.18s, color 0.18s;}
    .taxi-hire-btn.sms { background: var(--sms); color: #fff;}
    .taxi-hire-btn.whatsapp { background: var(--whatsapp); color: #fff;}
    .taxi-hire-btn.calc { background: var(--accent); color: #fff;}
    .taxi-hire-btn.map { background: #f8fafc; color: #2563eb;}
    .taxi-hire-btn.hide { background: #ddd; color: var(--danger);}
    .taxi-hire-btn:disabled { background: #ddd; color: #aaa;}
    .taxi-hire-status { margin: 0.7rem auto 0.2rem auto; text-align: center; font-size: 1.03em;}
    .taxi-hire-status.success { color: var(--primary-dark);}
    .taxi-hire-status.error { color: var(--danger);}
    .taxi-hire-map { display: none; width: 100%; height: 130px; border-radius: 7px; border: 1px solid #e0e0e0; margin-top: 0.5rem; background: #f8fafc; align-items: center; justify-content: center; color: #2563eb; font-weight: 500; font-size: 1.08em;}
    .taxi-hire-map.show { display: flex !important; }
    .checkout-actions { margin-top: 1rem; display: flex; gap: 12px; justify-content: center;}
    .checkout-btn-main { padding: 0.8rem 1.2rem; border-radius: 5px; font-size: 1.07rem; border: none; background: var(--accent); color: #fff; font-weight: 600; cursor: pointer; }
    .checkout-btn-main i { margin-right: 8px;}
    .checkout-btn-sms { background: var(--sms); color: #fff; border-radius: 50%; width: 42px; height: 42px; font-size: 1.35rem; border: none; display: flex; align-items: center; justify-content: center; cursor: pointer;}
    .checkout-btn-whatsapp { background: var(--whatsapp); color: #fff; border-radius: 50%; width: 42px; height: 42px; font-size: 1.35rem; border: none; display: flex; align-items: center; justify-content: center; cursor: pointer;}
    @media (max-width: 800px) {
      .slider-track { gap: 0.8rem; }
      .slider-section, .taxi-card { max-width: 99vw; }
      .product, .vehicle-item { min-width: 140px; }
      .modal-content { width: 98vw;}
    }
    footer {
      background: var(--footer-bg);
      color: var(--footer-text);
      text-align: center;
      padding: 1.5rem 1rem 1.7rem 1rem;
      border-radius: 18px 18px 0 0;
      font-size: 1.08rem;
      margin-top: 2.7rem;
      box-shadow: 0 -2px 8px rgba(0,0,0,0.04);
    }
    footer a { color: var(--footer-link); text-decoration: underline; font-weight: 500;}
    footer .footer-brand { font-weight: bold; color: var(--footer-link);}
  </style>
</head>
<body>
  <header>
    <div class="brand-title">Zam<span class="highlight">Listing</span></div>
    <h2 class="tagline">Get your Service</h2>
    <p class="subtitle">Click on a service below to proceed</p>
  </header>
  <div class="container">
    <div class="filter-search-section">
      <div>
        <label for="categoryFilter">Show Section:</label>
        <select id="categoryFilter">
          <option value="all">All</option>
          <option value="taxi">Taxi Hire</option>
          <option value="masampo">Masampo</option>
          <option value="bistore">B-istore</option>
        </select>
        <input type="text" id="searchBox" placeholder="Search products, vehicles..." aria-label="Search products, vehicles">
      </div>
    </div>
    <div class="slider-section" id="taxiSliderSection">
      <div class="slider-title"><i class="fa fa-taxi"></i> Taxi Hire</div>
      <button class="slider-btn prev" id="prevTaxiBtn" aria-label="Scroll left"><i class="fa fa-chevron-left"></i></button>
      <div class="slider-track" id="taxi-slider-track">
        <div class="taxi-card" id="taxiCard">
          <div class="taxi-emoji-animated">
            <span role="img" aria-label="vehicle">🚗</span>
            <span role="img" aria-label="motorbike">🏍️</span>
          </div>
          <span class="taxi-card-title"><span role="img" aria-label="taxi">🚕</span> Book a Taxi</span>
          <span class="taxi-card-desc">Hire a vehicle or motorbike for your trip. Quick, safe, and affordable!</span>
        </div>
      </div>
      <button class="slider-btn next" id="nextTaxiBtn" aria-label="Scroll right"><i class="fa fa-chevron-right"></i></button>
    </div>
    <div class="slider-section" id="masampoSliderSection">
      <div class="slider-title"><i class="fa fa-car"></i> Masampo</div>
      <button class="slider-btn prev" id="prevMasampoBtn" aria-label="Scroll left"><i class="fa fa-chevron-left"></i></button>
      <div class="slider-track" id="masampo-slider-track"></div>
      <button class="slider-btn next" id="nextMasampoBtn" aria-label="Scroll right"><i class="fa fa-chevron-right"></i></button>
    </div>
    <div class="slider-section" id="bistoreSliderSection">
      <div class="slider-title"><i class="fa fa-building"></i> B-istore</div>
      <button class="slider-btn prev" id="prevBistoreBtn" aria-label="Scroll left"><i class="fa fa-chevron-left"></i></button>
      <div class="slider-track" id="bistore-slider-track"></div>
      <button class="slider-btn next" id="nextBistoreBtn" aria-label="Scroll right"><i class="fa fa-chevron-right"></i></button>
    </div>
    <div class="cart" aria-label="Your Cart">
      <h2 class="section-title"><i class="fa fa-shopping-cart"></i> Your Order</h2>
      <ul id="cart-items" class="cart-items"></ul>
      <div id="empty-cart" class="empty-cart" aria-live="polite">
        <i class="fa fa-cart-arrow-down"></i>
        <p>Your cart is empty.</p>
        <p>Add items to get started.</p>
      </div>
      <div id="cart-total" class="cart-total" style="display:none;">
        <p>Products Total: ZK <span id="products-total">0.00</span></p>
        <p><strong>Total: ZK <span id="grand-total">0.00</span></strong></p>
      </div>
      <div class="checkout-actions" id="checkoutActions" style="display:none;">
        <button class="checkout-btn-main" id="checkout-btn">
          <i class="fa fa-credit-card"></i> Proceed to Checkout
        </button>
        <button class="checkout-btn-sms" id="checkout-btn-sms" title="Send Order SMS">
          <i class="fa fa-sms"></i>
        </button>
        <button class="checkout-btn-whatsapp" id="checkout-btn-whatsapp" title="Send Order WhatsApp">
          <i class="fa fa-whatsapp"></i>
        </button>
      </div>
      <div id="statusMessage" class="status-message"></div>
    </div>
    <div class="modal" id="taxiHireModal">
      <div class="modal-content">
        <button class="modal-close" id="taxiHireModalClose">&times;</button>
        <div class="modal-title">Taxi Hire Booking</div>
        <div style="font-size:2.5rem;margin-bottom:0.6rem;">
          <span>🚗</span>
          <span>🏍️</span>
        </div>
        <div style="width:100%">
          <label for="taxiPhoneModal">Phone Number</label>
          <input type="tel" id="taxiPhoneModal" maxlength="10" placeholder="e.g. 0978167546" style="width:100%;margin-bottom:0.7rem;">
          <label for="taxiHireMode">Mode</label>
          <select id="taxiHireMode" style="width:100%;margin-bottom:0.7rem;">
            <option value="vehicle">Vehicle 🚗</option>
            <option value="motorbike">Motorbike 🏍️</option>
          </select>
          <label for="taxiHireFrom">From</label>
          <input type="text" id="taxiHireFrom" placeholder="Pickup location" style="width:100%;margin-bottom:0.7rem;">
          <label for="taxiHireTo">To</label>
          <input type="text" id="taxiHireTo" placeholder="Drop-off location" style="width:100%;margin-bottom:0.7rem;">
        </div>
        <div class="taxi-hire-actions">
          <button class="taxi-hire-btn calc" id="taxiCalcBtn" title="Calculate Fare"><i class="fa fa-calculator"></i></button>
          <button class="taxi-hire-btn sms" id="taxiSmsBtn" title="Send Booking SMS"><i class="fa fa-sms"></i></button>
          <button class="taxi-hire-btn whatsapp" id="taxiWhatsappBtn" title="Send Booking WhatsApp"><i class="fa fa-whatsapp"></i></button>
          <button class="taxi-hire-btn map" id="taxiShowMapBtn" title="Show Map"><i class="fa fa-map"></i></button>
          <button class="taxi-hire-btn hide" id="taxiHideMapBtn" title="Hide Map" style="display:none;"><i class="fa fa-eye-slash"></i></button>
        </div>
        <div class="taxi-hire-status" id="taxiHireStatus"></div>
        <div id="taxiHireMap" class="taxi-hire-map">Map will appear here (Demo)</div>
        <button class="btn btn-accent" id="taxiHireSubmitBtn" style="margin-top:0.5rem;">Submit Booking</button>
      </div>
    </div>
    <div class="modal" id="detailsModal">
      <div class="modal-content" id="detailsModalContent">
        <button class="modal-close" id="detailsModalClose">&times;</button>
        <div class="modal-title" id="detailsModalTitle"></div>
        <div class="modal-imgs" id="detailsModalImgs"></div>
        <div class="modal-slider-arrows" id="detailsModalArrows" style="display:none;">
          <button class="modal-slider-arrow" id="detailsModalPrevImg">&lt;</button>
          <button class="modal-slider-arrow" id="detailsModalNextImg">&gt;</button>
        </div>
        <img id="detailsModalImg" class="modal-img" src="" alt="Item Image">
        <div class="modal-details" id="detailsModalDetails"></div>
      </div>
    </div>
  </div>
  <footer>
    <div class="footer-brand">ZamListing</div>
    <div>
      &copy; 2025 ZamListing &middot; Powered by <a href="https://github.com/">GitHub</a>
    </div>
    <div>
      <span>Contact: <a href="mailto:support@zamlisting.com">support@zamlisting.com</a></span>
    </div>
  </footer>
  <script>
    // Data
    const MASAMPO_VEHICLES = [
      {
        id: 1001, name: "Toyota Corolla 2015", price: 120000, location: "Luangwa Market",
        image: "corolla.jpg", category: "vehicle", details: { condition: "Used, good condition", contact: "0971234567" },
        additionalImages: ["corolla.jpg", "corolla_front.jpg", "corolla_side.jpg"], listedDate: "2025-08-01"
      },
      {
        id: 1002, name: "Honda CR-V 2018", price: 200000, location: "Katondwe Mission Hospital",
        image: "crv.jpg", category: "vehicle", details: { condition: "Excellent, low mileage", contact: "0966543210" },
        additionalImages: ["crv.jpg", "crv_front.jpg", "crv_rear.jpg"], listedDate: "2025-07-15"
      }
    ];
    const BISTORE_PRODUCTS = [
      { from: "Luangwa (Feira)", to: "Kapoche", distance: 28 },
      { from: "Luangwa (Feira)", to: "Katondwe Mission Hospital", distance: 52 },
      { from: "Luangwa (Feira)", to: "Luangwa Market", distance: 0.1 },
      { from: "Luangwa Market", to: "Luangwa (Feira)", distance: 0.1 },
      { from: "Luangwa (Feira)", to: "Luangwa District Hospital", distance: 4.6 },
      { from: "Luangwa (Feira)", to: "Kakaro Primary School", distance: 12 },
      { from: "Luangwa District Hospital", to: "Kavalamanja", distance: 23 },
      { from: "Katondwe Mission Hospital", to: "Kasinsa", distance: 16 },
      { from: "Chitope", to: "Kasinsa", distance: 10 },
      { from: "Luangwa (Feira)", to: "Luangwa Police Station", distance: 0.55 },
      { from: "Luangwa (Feira)", to: "Makichilo Lodge", distance: 0.40 },
      { from: "Luangwa (Feira)", to: "Anglican Church", distance: 0.75 },
      { from: "Luangwa (Feira)", to: "Feira Kindom Hall", distance: 0.7 },
      { from: "Luangwa (Feira)", to: "UCZ", distance: 0.5 },
      { from: "Luangwa (Feira)", to: "Pentocostal Assembly of God Joshua Assembly", distance: 0.6 },
      { from: "Luangwa Police Station", to: "Luangwa Post Office", distance: 1.1 },
      { from: "Luangwa Post Office", to: "Luangwa District Comission office", distance: 0 },
      { from: "Luangwa Market", to: "Luangwa Basic School", distance: 0.45 },
      { from: "Luangwa Market", to: "Luangwa Habour", distance: 0.5 },
      { from: "Luangwa (Feira)", to: "Luangwa Indeco", distance: 0.9 },
      { from: "Luangwa Indeco", to: "Luangwa Council lodge", distance: 0.25 },
      { from: "Luangwa Council lodge", to: "Yangoma Hotel", distance: 0.15 },
      { from: "Luangwa Council lodge", to: "Zambia Electricity Supply Corporation", distance: 2.4 },
      { from: "Yangoma Hotel", to: "Luangwa Filling Station", distance: 0.7 },
      { from: "Kantuleni executive Lodge", to: "Luangwa Filling Station", distance: 0.190 },
      { from: "Luangwa Filling Station", to: "Dzalo Skills Training Centre kambolozo", distance: 0.3 },
      { from: "Dzalo Skills Training Centre kambolozo", to: "Boma Clinic", distance: 0.2 },
      { from: "Boma Clinic", to: "BM residence", distance: 0.6 },
      { from: "BM residence", to: "Luangwa Feira Day Secondary School", distance: 1.1 },
      { from: "Gerasmos Safari Lodge", to: "Luangwa Feira Day Secondary School", distance: 3.1 },
      { from: "Luangwa Feira Day Secondary School", to: "Justifeli Lodge", distance: 2.2 },
      { from: "Luangwa main sda churh", to: "Justifeli Lodge", distance: 0.9 },
      { from: "Luangwa District Education Board Offices", to: "Justifeli Lodge", distance: 2.0 },
      { from: "Luangwa Feira Day Secondary School", to: "yellow shop", distance: 3.3 },
      { from: "Luangwa Feira Day Secondary School", to: "Zambia Electricity Supply Corporation", distance: 2.0 },
      { from: "yellow shop", to: "JB THREE BOARDERS MALL", distance: 0.45 },
      { from: "yellow shop", to: "Luangwa Indeco", distance: 0.45 },
      { from: "yellow shop", to: "Luangwa main sda churh", distance: 0.70 },
      { from: "Luangwa main sda churh", to: "Zambia Electricity Supply Corporation", distance: 0.65 },
      { from: "Luangwa District Hospital", to: "Zambia Electricity Supply Corporation", distance: 2.8 },
      { from: "Luangwa Feira Day Secondary School", to: "Big 2 Zambezi Water Front Resort & Safari", distance: 4.0 },
      { from: "Luangwa Feira Day Secondary School", to: "Katondwe Mission Hospital", distance: 48 },
      { from: "Katondwe Mission Hospital", to: "Mwavi Secondary School", distance: 7.2 },
      { from: "Mwavi Secondary School", to: "Luangwa Bridge Market", distance: 27.3 },
      { from: "Mwavi Secondary School", to: "Chitope", distance: 1.1 },
      { from: "Chitope", to: "Luangwa Secondary School", distance: 14 },
      { from: "Luangwa Bridge Market", to: "Luangwa Bridge", distance: 12.7 }
    ];
    const luangwaPlaces = [
      "Luangwa (Feira)", "Chitope", "Luangwa Market", "Kasinsa", "Kapoche",
      "Kakaro Primary School", "Makichilo Lodge", "Gerasmos Safari Lodge",
      "Justifeli Lodge", "Kantuleni executive Lodge", "Feira Kindom Hall",
      "Luangwa main sda churh", "Pentocostal Assembly of God Joshua Assembly",
      "UCZ", "JB THREE BOARDERS MALL", "yellow shop", "Anglican Church",
      "Big 2 Zambezi Water Front Resort & Safari", "Luangwa Secondary School",
      "Luangwa District Hospital", "Kavalamanja", "Luangwa Police Station",
      "Zambia Electricity Supply Corporation", "Luangwa Post Office",
      "Luangwa Basic School", "Luangwa Habour", "Luangwa Indeco",
      "Luangwa District Comission office", "Luangwa District Education Board Offices",
      "Luangwa Council lodge", "Yangoma Hotel", "Luangwa Filling Station",
      "Dzalo Skills Training Centre kambolozo", "Boma Clinic", "BM residence",
      "Luangwa Feira Day Secondary School", "Katondwe Mission Hospital",
      "Mwavi Secondary School", "Luangwa Bridge", "Luangwa Bridge Market"
    ];
    const segments = [
      { from: "Luangwa (Feira)", to: "Luangwa Market", distance: 0.1 },
      { from: "Luangwa (Feira)", to: "Katondwe Mission Hospital", distance: 52 },
      { from: "Luangwa (Feira)", to: "Kapoche", distance: 28 },
      { from: "Chitope", to: "Kapoche", distance: 10 }
    ];
    // Filtering and Section Logic
    let sectionMap = {
      "taxi": document.getElementById("taxiSliderSection"),
      "masampo": document.getElementById("masampoSliderSection"),
      "bistore": document.getElementById("bistoreSliderSection"),
      "all": null
    };
    document.getElementById("categoryFilter").addEventListener("change", function() {
      let val = this.value;
      Object.entries(sectionMap).forEach(([key, sec]) => {
        if (sec) sec.hidden = (val !== "all" && val !== key);
      });
    });
    // Filtering for items
    let filteredMasampo = MASAMPO_VEHICLES.slice();
    let filteredBistore = BISTORE_PRODUCTS.slice();
    function updateAllFilters() {
      const selectedCategory = categoryFilter.value;
      const query = searchBox.value.trim().toLowerCase();
      filteredMasampo = MASAMPO_VEHICLES.filter(v => {
        const matchQuery = v.name.toLowerCase().includes(query) || (v.category && v.category.toLowerCase().includes(query)) || (v.location && v.location.toLowerCase().includes(query));
        return matchQuery;
      });
      filteredBistore = BISTORE_PRODUCTS.filter(p => {
        const matchQuery = p.name.toLowerCase().includes(query) || (p.category && p.category.toLowerCase().includes(query));
        return matchQuery;
      });
      renderMasampo();
      renderBistore();
    }
    const searchBox = document.getElementById('searchBox');
    searchBox.addEventListener('input', updateAllFilters);

    // Slider
    function setupSliderButtons(trackId, prevBtnId, nextBtnId) {
      const sliderTrack = document.getElementById(trackId);
      document.getElementById(prevBtnId).onclick = () => {
        sliderTrack.scrollBy({ left: -180, behavior: 'smooth' });
      };
      document.getElementById(nextBtnId).onclick = () => {
        sliderTrack.scrollBy({ left: 180, behavior: 'smooth' });
      };
    }
    setupSliderButtons('taxi-slider-track', 'prevTaxiBtn', 'nextTaxiBtn');
    setupSliderButtons('masampo-slider-track', 'prevMasampoBtn', 'nextMasampoBtn');
    setupSliderButtons('bistore-slider-track', 'prevBistoreBtn', 'nextBistoreBtn');

    // Render
    function renderMasampo() {
      const masampoSliderTrack = document.getElementById('masampo-slider-track');
      masampoSliderTrack.innerHTML = '';
      filteredMasampo.forEach(item => {
        const div = document.createElement('div');
        div.className = 'vehicle-item';
        div.tabIndex = 0;
        div.setAttribute('aria-label', `${item.name}, ZK ${item.price.toLocaleString()}`);
        div.innerHTML = `
          <img src="${item.image}" alt="${item.name}" onerror="this.src='https://via.placeholder.com/82?text=Error';">
          <h4>${item.name}</h4>
          <p>ZK ${item.price.toLocaleString()}</p>
          <p class="location">${item.location}</p>
        `;
        div.onclick = () => showDetailsModal(item, 'masampo');
        masampoSliderTrack.appendChild(div);
      });
    }
    function renderBistore() {
      const bistoreSliderTrack = document.getElementById('bistore-slider-track');
      bistoreSliderTrack.innerHTML = '';
      filteredBistore.forEach(p => {
        const div = document.createElement('div');
        div.className = 'product';
        div.tabIndex = 0;
        div.setAttribute('aria-label', `${p.name}, ZK ${p.price.toFixed(2)}`);
        let outStock = (p.price <= 0);
        div.innerHTML = `
          <img src="${p.image}" alt="${p.name}" onerror="this.src='https://via.placeholder.com/82?text=Error';">
          <h4>${p.name}</h4>
          <p>ZK ${p.price.toFixed(2)}</p>
          ${outStock ? '<span class="out-stock">Out of Stock</span>' : ''}
          <button data-id="${p.id}" ${outStock ? 'disabled' : ''} style="margin-bottom:0.3rem;">
            <i class="fa fa-plus"></i> Add
          </button>
        `;
        div.onclick = (e) => {
          if (e.target.closest('button')) return;
          showDetailsModal(p, 'bistore');
        };
        bistoreSliderTrack.appendChild(div);
      });
    }
    document.addEventListener('DOMContentLoaded', () => {
      renderMasampo();
      renderBistore();
      updateCart();
    });

    // Taxi Hire Modal Logic
    const taxiCard = document.getElementById('taxiCard');
    const taxiHireModal = document.getElementById('taxiHireModal');
    const taxiHireModalClose = document.getElementById('taxiHireModalClose');
    const taxiCalcBtn = document.getElementById('taxiCalcBtn');
    const taxiSmsBtn = document.getElementById('taxiSmsBtn');
    const taxiWhatsappBtn = document.getElementById('taxiWhatsappBtn');
    const taxiShowMapBtn = document.getElementById('taxiShowMapBtn');
    const taxiHideMapBtn = document.getElementById('taxiHideMapBtn');
    const taxiHireMap = document.getElementById('taxiHireMap');
    const taxiHireStatus = document.getElementById('taxiHireStatus');
    taxiCard.onclick = () => { taxiHireModal.style.display = "flex"; taxiHireMap.classList.remove("show"); taxiShowMapBtn.style.display=""; taxiHideMapBtn.style.display="none"; taxiHireStatus.textContent=""; taxiHireStatus.className="taxi-hire-status";};
    taxiHireModalClose.onclick = () => { taxiHireModal.style.display = "none"; };
    taxiShowMapBtn.onclick = () => { taxiHireMap.classList.add("show"); taxiShowMapBtn.style.display="none"; taxiHideMapBtn.style.display=""; };
    taxiHideMapBtn.onclick = () => { taxiHireMap.classList.remove("show"); taxiShowMapBtn.style.display=""; taxiHideMapBtn.style.display="none"; };
    function taxiFindDistance(from, to) {
      const graph = {};
      segments.forEach(seg => {
        if (!graph[seg.from]) graph[seg.from] = [];
        if (!graph[seg.to]) graph[seg.to] = [];
        graph[seg.from].push({ place: seg.to, distance: seg.distance });
        graph[seg.to].push({ place: seg.from, distance: seg.distance });
      });
      if (!graph[from] || !graph[to]) return null;
      const distances = {}, visited = new Set();
      luangwaPlaces.forEach(place => distances[place] = Infinity);
      distances[from] = 0;
      let queue = [{ place: from, dist: 0 }];
      while (queue.length > 0) {
        queue.sort((a, b) => a.dist - b.dist);
        const { place, dist } = queue.shift();
        if (place === to) return dist;
        if (visited.has(place)) continue;
        visited.add(place);
        for (let neighbor of (graph[place] || [])) {
          if (dist + neighbor.distance < distances[neighbor.place]) {
            distances[neighbor.place] = dist + neighbor.distance;
            queue.push({ place: neighbor.place, dist: distances[neighbor.place] });
          }
        }
      }
      return null;
    }
    taxiCalcBtn.onclick = () => {
      const from = document.getElementById('taxiHireFrom').value.trim();
      const to = document.getElementById('taxiHireTo').value.trim();
      const mode = document.getElementById('taxiHireMode').value;
      if (!from || !to) {
        taxiHireStatus.textContent = "Please enter both pickup and drop-off locations.";
        taxiHireStatus.className = "taxi-hire-status error";
        return;
      }
      let dist = taxiFindDistance(from, to);
      if (!dist) {
        taxiHireStatus.textContent = "No known route between selected places.";
        taxiHireStatus.className = "taxi-hire-status error";
        return;
      }
      const rates = { vehicle: 20, motorbike: 10 };
      let cost = Math.ceil(dist / 3) * rates[mode];
      taxiHireStatus.textContent = `Distance: ${dist} km. Fare: ZK ${cost} (${mode === 'vehicle' ? 'Vehicle' : 'Motorbike'})`;
      taxiHireStatus.className = "taxi-hire-status success";
    };
    taxiSmsBtn.onclick = () => {
      const phone = document.getElementById('taxiPhoneModal').value.trim();
      const mode = document.getElementById('taxiHireMode').value;
      const from = document.getElementById('taxiHireFrom').value.trim();
      const to = document.getElementById('taxiHireTo').value.trim();
      let dist = taxiFindDistance(from, to) || "N/A";
      const rates = { vehicle: 20, motorbike: 10 };
      let cost = dist === "N/A" ? "N/A" : Math.ceil(dist / 3) * rates[mode];
      const msg = `Taxi Booking:\nMode: ${mode}\nFrom: ${from}\nTo: ${to}\nCustomer: ${phone}\nDistance: ${dist} km\nFare: ZK ${cost}`;
      window.open(`sms:+260978167546?body=${encodeURIComponent(msg)}`, "_blank");
      taxiHireStatus.textContent = "Booking sent via SMS!";
      taxiHireStatus.className = "taxi-hire-status success";
    };
    taxiWhatsappBtn.onclick = () => {
      const phone = document.getElementById('taxiPhoneModal').value.trim();
      const mode = document.getElementById('taxiHireMode').value;
      const from = document.getElementById('taxiHireFrom').value.trim();
      const to = document.getElementById('taxiHireTo').value.trim();
      let dist = taxiFindDistance(from, to) || "N/A";
      const rates = { vehicle: 20, motorbike: 10 };
      let cost = dist === "N/A" ? "N/A" : Math.ceil(dist / 3) * rates[mode];
      const msg = `Taxi Booking:\nMode: ${mode}\nFrom: ${from}\nTo: ${to}\nCustomer: ${phone}\nDistance: ${dist} km\nFare: ZK ${cost}`;
      window.open(`https://wa.me/+260978167546?text=${encodeURIComponent(msg)}`, "_blank");
      taxiHireStatus.textContent = "Booking sent via WhatsApp!";
      taxiHireStatus.className = "taxi-hire-status success";
    };
    document.getElementById('taxiHireSubmitBtn').onclick = () => {
      const phone = document.getElementById('taxiPhoneModal').value.trim();
      const mode = document.getElementById('taxiHireMode').value;
      const from = document.getElementById('taxiHireFrom').value.trim();
      const to = document.getElementById('taxiHireTo').value.trim();
      if (!/^0[0-9]{9}$/.test(phone)) {
        taxiHireStatus.textContent = "Please enter a valid phone number (e.g. 0978167546).";
        taxiHireStatus.className = "taxi-hire-status error";
        return;
      }
      if (!from || !to) {
        taxiHireStatus.textContent = "Please enter both pickup and drop-off locations.";
        taxiHireStatus.className = "taxi-hire-status error";
        return;
      }
      taxiHireStatus.textContent = "Taxi booking submitted!";
      taxiHireStatus.className = "taxi-hire-status success";
      setTimeout(() => { taxiHireModal.style.display = "none"; }, 1300);
    };
    // Details Modal for Masampo and B-istore
    const detailsModal = document.getElementById('detailsModal');
    const detailsModalClose = document.getElementById('detailsModalClose');
    const detailsModalTitle = document.getElementById('detailsModalTitle');
    const detailsModalImg = document.getElementById('detailsModalImg');
    const detailsModalDetails = document.getElementById('detailsModalDetails');
    const detailsModalImgs = document.getElementById('detailsModalImgs');
    const detailsModalArrows = document.getElementById('detailsModalArrows');
    const detailsModalPrevImg = document.getElementById('detailsModalPrevImg');
    const detailsModalNextImg = document.getElementById('detailsModalNextImg');
    let currentDetailsImages = [];
    let currentDetailsIndex = 0;
    function showDetailsModal(item, type) {
      detailsModalTitle.textContent = item.name;
      let imgList = [];
      if (type === 'masampo' && item.additionalImages && item.additionalImages.length) {
        imgList = item.additionalImages;
      } else if (item.image) {
        imgList = [item.image];
      }
      currentDetailsImages = imgList;
      currentDetailsIndex = 0;
      detailsModalImg.src = imgList[0] || '';
      detailsModalImgs.innerHTML = '';
      imgList.forEach((img, idx) => {
        const thumb = document.createElement('img');
        thumb.src = img;
        thumb.className = idx === 0 ? 'selected' : '';
        thumb.onclick = () => { selectDetailsImage(idx); };
        detailsModalImgs.appendChild(thumb);
      });
      detailsModalArrows.style.display = imgList.length > 1 ? '' : 'none';
      detailsModalPrevImg.disabled = currentDetailsIndex === 0;
      detailsModalNextImg.disabled = currentDetailsIndex === imgList.length - 1;
      let html = '';
      if (type === 'masampo') {
        html += `<div><b>Price:</b> ZK ${item.price.toLocaleString()}</div>`;
        html += `<div><b>Location:</b> ${item.location}</div>`;
        html += `<div><b>Condition:</b> ${item.details?.condition || ''}</div>`;
        html += `<div><b>Contact:</b> ${item.details?.contact || ''}</div>`;
        html += `<div><b>Listed Since:</b> ${item.listedDate || ''}</div>`;
      } else {
        html += `<div><b>Price:</b> ZK ${item.price}</div>`;
        html += `<div><b>Category:</b> ${item.category}</div>`;
      }
      detailsModalDetails.innerHTML = html;
      detailsModal.style.display = "flex";
    }
    function selectDetailsImage(idx) {
      currentDetailsIndex = idx;
      detailsModalImg.src = currentDetailsImages[idx];
      Array.from(detailsModalImgs.children).forEach((img, i) => {
        img.className = i === idx ? 'selected' : '';
      });
      detailsModalPrevImg.disabled = currentDetailsIndex === 0;
      detailsModalNextImg.disabled = currentDetailsIndex === currentDetailsImages.length - 1;
    }
    detailsModalPrevImg.onclick = () => {
      if (currentDetailsIndex > 0) selectDetailsImage(currentDetailsIndex - 1);
    };
    detailsModalNextImg.onclick = () => {
      if (currentDetailsIndex < currentDetailsImages.length - 1) selectDetailsImage(currentDetailsIndex + 1);
    };
    detailsModalClose.onclick = () => { detailsModal.style.display = "none"; };

    // Cart Logic
    let cart = [];
    const cartItemsEl = document.getElementById('cart-items');
    const emptyCartEl = document.getElementById('empty-cart');
    const cartTotalEl = document.getElementById('cart-total');
    const productsTotalEl = document.getElementById('products-total');
    const grandTotalEl = document.getElementById('grand-total');
    const checkoutBtn = document.getElementById('checkout-btn');
    const checkoutActions = document.getElementById('checkoutActions');
    const checkoutBtnSms = document.getElementById('checkout-btn-sms');
    const checkoutBtnWhatsapp = document.getElementById('checkout-btn-whatsapp');
    function updateCart() {
      if (cart.length === 0) {
        cartItemsEl.innerHTML = '';
        emptyCartEl.style.display = 'block';
        cartTotalEl.style.display = 'none';
        checkoutActions.style.display = 'none';
      } else {
        emptyCartEl.style.display = 'none';
        cartTotalEl.style.display = 'block';
        checkoutActions.style.display = 'flex';
        cartItemsEl.innerHTML = '';
        cart.forEach((item, index) => {
          const li = document.createElement('li');
          li.innerHTML = `
            <div class="cart-item-info">
              <img src="${item.item.image}" alt="${item.item.name}" class="cart-thumb" onerror="this.src='https://via.placeholder.com/36?text=Err';">
              <span class="cart-item-title">${item.item.name}</span>
            </div>
            <div class="cart-price-block">
              <span style="min-width:60px;">ZK ${(item.item.price * item.quantity).toFixed(2)}</span>
              <div class="quantity-controls">
                <button class="quantity-btn decrease" data-index="${index}">-</button>
                <input type="number" min="1" class="cart-item-qty" data-index="${index}" value="${item.quantity}">
                <button class="quantity-btn increase" data-index="${index}">+</button>
                <button class="remove-btn" data-index="${index}"><i class="fa fa-times"></i></button>
              </div>
            </div>
          `;
          cartItemsEl.appendChild(li);
        });
        const productsTotal = cart.reduce((sum, item) => sum + item.item.price * item.quantity, 0);
        productsTotalEl.textContent = productsTotal.toFixed(2);
        grandTotalEl.textContent = productsTotal.toFixed(2);
      }
    }
    document.getElementById('bistore-slider-track').addEventListener('click', function(e) {
      const btn = e.target.closest('button[data-id]');
      if (!btn) return;
      const id = parseInt(btn.getAttribute('data-id'), 10);
      const item = BISTORE_PRODUCTS.find(p => p.id === id);
      if (item) {
        const cartItem = cart.find(cartItem => cartItem.item.id === id);
        if (cartItem) { cartItem.quantity += 1; }
        else { cart.push({ item: item, quantity: 1 }); }
        updateCart();
      }
    });
    cartItemsEl.addEventListener('click', e => {
      const button = e.target.closest('button');
      if (!button) return;
      const index = parseInt(button.dataset.index, 10);
      if (button.classList.contains('remove-btn')) {
        cart.splice(index, 1);
        updateCart();
      } else if (button.classList.contains('increase')) {
        cart[index].quantity += 1;
        updateCart();
      } else if (button.classList.contains('decrease')) {
        cart[index].quantity -= 1;
        if (cart[index].quantity === 0) {
          cart.splice(index, 1);
        }
        updateCart();
      }
    });
    cartItemsEl.addEventListener('change', e => {
      const input = e.target;
      if (input.classList.contains('cart-item-qty')) {
        let idx = parseInt(input.dataset.index, 10);
        let qty = parseInt(input.value, 10);
        if (!isNaN(qty) && qty >= 1) {
          cart[idx].quantity = qty;
          updateCart();
        } else {
          input.value = cart[idx].quantity;
        }
      }
    });
    checkoutBtn.onclick = () => {
      if (cart.length === 0) {
        alert('Your cart is empty.');
        return;
      }
      alert("Order submitted successfully!");
      cart = [];
      updateCart();
    };
    checkoutBtnSms.onclick = () => {
      if (cart.length === 0) {
        alert('Your cart is empty.');
        return;
      }
      const msg = cart.map(item => `${item.item.name} x${item.quantity} = ZK ${(item.item.price * item.quantity).toFixed(2)}`).join('\n');
      window.open(`sms:+260978167546?body=${encodeURIComponent("Order:\n"+msg)}`, "_blank");
    };
    checkoutBtnWhatsapp.onclick = () => {
      if (cart.length === 0) {
        alert('Your cart is empty.');
        return;
      }
      const msg = cart.map(item => `${item.item.name} x${item.quantity} = ZK ${(item.item.price * item.quantity).toFixed(2)}`).join('\n');
      window.open(`https://wa.me/+260978167546?text=${encodeURIComponent("Order:\n"+msg)}`, "_blank");
    };
  </script>
</body>
  </html>
