<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ZamListing</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"/>
  <style>
    :root {
      --primary: #2e7d32;
      --primary-dark: #1b5e20;
      --primary-light: #81c784;
      --accent: #ff9800;
      --text: #222;
      --text-light: #666;
      --background: #f5f5f5;
      --card-bg: white;
      --border: #e0e0e0;
      --shadow: 0 0 8px rgba(0,0,0,0.05);
      --success: #e8f5e9;
      --error: #ffebee;
      --danger: #c62828;
      --whatsapp: #25d366;
      --sms: #ff9800;
      --footer-bg: #2e7d32;
      --footer-text: #fff;
      --footer-link: #ffd600;
    }
    * {
      box-sizing: border-box;
    }
    body {
      font-family: 'Roboto', sans-serif;
      color: var(--text);
      background: var(--background);
      line-height: 1.5;
      margin: 0;
    }
    header {
      background: linear-gradient(135deg, var(--primary), var(--primary-dark) 90%);
      color: white;
      padding: 2.2rem 1rem 1.5rem 1rem;
      text-align: center;
    }
    .brand-title {
      font-size: 2.6rem;
      font-weight: 900;
      letter-spacing: 0.05em;
      color: var(--primary-dark);
      text-shadow: 0 1px 0 #fff;
      margin-bottom: 0.6rem;
    }
    .brand-title .highlight {
      color: var(--accent);
      text-shadow: none;
    }
    .tagline {
      font-size: 1.45rem;
      font-weight: 500;
      color: var(--primary);
      margin-bottom: 0.45rem;
    }
    .subtitle {
      font-size: 1.1rem;
      color: var(--text-light);
      margin-bottom: 1.2rem;
      margin-top: -0.5rem;
    }
    .container {
      max-width: 1200px;
      margin: 2rem auto;
      padding: 0 1rem;
      display: flex;
      flex-direction: column;
      gap: 2rem;
    }
    .filter-search-section {
      width: 100%;
      margin-bottom: 1.5rem;
    }
    .filter-search-section > div {
      display: flex;
      gap: 1rem;
      align-items: center;
      flex-wrap: wrap;
    }
    .filter-search-section label {
      font-weight: 500;
    }
    .filter-search-section select,
    .filter-search-section input[type="text"] {
      padding: 0.7rem;
      border-radius: 4px;
      border: 1px solid #ccc;
      font-size: 1.1rem;
      min-width: 120px;
    }
    .slider-section {
      position: relative;
      width: 100%;
      margin-bottom: 2rem;
      background: var(--card-bg);
      border-radius: 12px;
      box-shadow: var(--shadow);
      padding: 1.5rem 1rem 1rem;
    }
    .slider-title {
      font-size: 1.42rem;
      margin-bottom: 1.1rem;
      color: var(--primary-dark);
      font-weight: 600;
      text-align: left;
    }
    .slider-track {
      display: flex;
      overflow-x: auto;
      gap: 1.4rem;
      scroll-behavior: smooth;
      padding-bottom: 16px;
      padding-top: 6px;
      scrollbar-width: thin;
    }
    .slider-track::-webkit-scrollbar {
      height: 8px;
    }
    .slider-track::-webkit-scrollbar-thumb {
      background: var(--primary-light);
      border-radius: 4px;
    }
    .slider-btn {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(0,0,0,0.63);
      border: none;
      color: white;
      width: 38px;
      height: 38px;
      border-radius: 50%;
      font-size: 1.3rem;
      cursor: pointer;
      transition: background 0.2s;
    }
    .slider-btn:hover {
      background: rgba(0,0,0,0.81);
    }
    .slider-btn:disabled {
      display: none;
    }
    .slider-btn.prev {
      left: 10px;
    }
    .slider-btn.next {
      right: 10px;
    }
    .slider-btn .fa {
      color: white;
      line-height: 38px;
      vertical-align: middle;
      aria-hidden: true;
    }
    .slider-btn.prev::after {
      content: '<';
      display: none;
    }
    .slider-btn.next::after {
      content: '>';
      display: none;
    }
    .slider-section[hidden] {
      display: none !important;
    }
    .taxi-card {
      min-width: 250px;
      max-width: 270px;
      margin: 0 auto;
      background: linear-gradient(120deg, #e0f7fa 60%, #fceabb 100%);
      border-radius: 15px;
      box-shadow: 0 2px 22px rgba(0,0,0,0.12);
      padding: 1.3rem 1rem;
      transition: box-shadow 0.2s, transform 0.17s;
    }
    .taxi-card:hover {
      box-shadow: 0 7px 26px rgba(0,0,0,0.15);
      transform: scale(1.04);
      cursor: pointer;
    }
    .taxi-card-title {
      font-size: 1.17rem;
      font-weight: 600;
      color: var(--primary-dark);
      display: block;
      text-align: center;
      margin-bottom: 0.15rem;
    }
    .taxi-card-desc {
      color: var(--text-light);
      font-size: 1.01rem;
      text-align: center;
      margin-bottom: 0.2rem;
    }
    .fa {
      font-family: FontAwesome !important;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      display: inline-block;
      text-decoration: none;
      vertical-align: middle;
      font-size: 14px;
      line-height: 1;
      text-align: center;
      margin: 4px;
    }
    .fa-whatsapp {
      color: var(--whatsapp);
    }
    .fa-comment {
      color: var(--sms);
    }
    .product,
    .vehicle-item {
      min-width: 160px;
      max-width: 170px;
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 1rem 0.7rem;
      text-align: center;
      background: var(--card-bg);
      transition: box-shadow 0.2s, transform 0.17s;
    }
    .product:hover,
    .vehicle-item:hover {
      transform: translateY(-7px) scale(1.04);
      box-shadow: 0 7px 26px rgba(0,0,0,0.15);
    }
    .product img,
    .vehicle-item img {
      width: 140px;
      height: 100px;
      object-fit: cover;
      margin-bottom: 0.5rem;
      border-radius: 4px;
      border: 2px solid var(--primary-light);
      background: #fff;
    }
    .product img[onerror],
    .vehicle-item img[onerror] {
      content: url('https://via.placeholder.com/140x100?text=Image+Not+Found');
    }
    .product h4,
    .vehicle-item h4 {
      font-size: 1rem;
      margin-bottom: 0.2rem;
      color: var(--text);
    }
    .product p,
    .vehicle-item p {
      color: var(--primary-dark);
      font-weight: 600;
      margin-bottom: 0.6rem;
    }
    .vehicle-item p.location {
      font-size: 0.9rem;
      color: var(--text-light);
      margin-bottom: 0.2rem;
    }
    .product .out-stock {
      display: block;
      color: #b71c1c;
      font-size: 0.97em;
      font-weight: 600;
      margin-bottom: 0.7em;
    }
    .product button,
    .vehicle-item button {
      border: none;
      background: var(--primary);
      color: white;
      padding: 0.4rem 0.8rem;
      border-radius: 5px;
      cursor: pointer;
      font-family: inherit;
      font-weight: 500;
      transition: background 0.2s;
    }
    .product button:hover,
    .vehicle-item button:hover {
      background: var(--primary-dark);
    }
    .product button:disabled,
    .vehicle-item button:disabled {
      background: #ccc !important;
      cursor: not-allowed;
    }
    .cart {
      border: 1px solid var(--border);
      padding: 1.7rem 1.3rem 2.1rem;
      border-radius: 10px;
      flex: 1;
      min-width: 300px;
      background: var(--card-bg);
      position: sticky;
      top: 1rem;
      box-shadow: var(--shadow);
    }
    .cart-items {
      list-style: none;
      padding: 0;
      margin: 0 0 1.5rem;
      max-height: 320px;
      overflow-y: auto;
    }
    .cart-items li {
      padding: 0.8rem 0;
      border-bottom: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 0.2em;
      animation: fadein 0.33s;
      min-height: 54px;
    }
    .cart-items li:last-child {
      border-bottom: none;
    }
    .cart-thumb {
      width: 36px;
      height: 36px;
      object-fit: cover;
      border-radius: 4px;
      margin-right: 8px;
      vertical-align: middle;
      border: 1.5px solid #e5e7eb;
      background: #fff;
    }
    .cart-thumb[onerror] {
      content: url('https://via.placeholder.com/36x36?text=Image+Not+Found');
    }
    .cart-item-info {
      display: flex;
      align-items: center;
      flex: 1;
      min-width: 0;
    }
    .cart-item-title {
      font-weight: 500;
      font-size: 1.04em;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .cart-price-block {
      display: flex;
      align-items: center;
      gap: 4px;
    }
    .quantity-controls {
      display: flex;
      align-items: center;
      gap: 2px;
    }
    .quantity-btn,
    .remove-btn {
      border: none;
      background: none;
      color: var(--primary-dark);
      font-size: 1.1em;
      margin: 0 2px;
      cursor: pointer;
      padding: 2px 6px;
      border-radius: 4px;
      transition: background 0.2s;
    }
    .quantity-btn:hover,
    .remove-btn:hover {
      background: #f1f1f1;
    }
    .quantity-btn:active,
    .remove-btn:active {
      background: #e0e0e0;
    }
    .remove-btn {
      color: var(--danger);
    }
    .cart-total {
      margin: 1rem 0;
      padding-top: 1rem;
      border-top: 1px solid var(--border);
    }
    .cart-total p {
      margin: 0.5rem 0;
    }
    .checkout-actions {
      margin-top: 1rem;
      display: flex;
      gap: 14px;
      justify-content: center;
      flex-wrap: wrap;
    }
    .checkout-btn-sms,
    .checkout-btn-whatsapp {
      border: none;
      background: none;
      padding: 0 8px;
      font-size: 1em;
      font-weight: 600;
      color: var(--text);
      display: inline-flex;
      align-items: center;
      cursor: pointer;
      transition: background 0.2s;
    }
    .checkout-btn-sms:hover,
    .checkout-btn-whatsapp:hover {
      background: #f1f1f1;
    }
    .checkout-btn-sms .fa-comment,
    .checkout-btn-whatsapp .fa-whatsapp {
      margin-right: 6px;
      font-size: 14px;
      line-height: 1;
      vertical-align: middle;
      aria-hidden: true;
    }
    .status-message {
      margin: 0.7rem auto 0.2rem auto;
      text-align: center;
      font-size: 1.03em;
    }
    .status-message.success {
      color: var(--primary-dark);
    }
    .status-message.error {
      color: var(--danger);
    }
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0,0,0,0.5);
      z-index: 2000;
      align-items: center;
      justify-content: center;
      overflow: auto;
    }
    .modal.show {
      display: flex !important;
    }
    .modal-content {
      background: #fff;
      border-radius: 8px;
      padding: 1.5rem;
      max-width: 90vw;
      max-height: 90vh;
      width: 100%;
      height: auto;
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      overflow-y: auto;
      box-sizing: border-box;
    }
    .modal-close {
      position: fixed;
      top: 1rem;
      right: 1rem;
      font-size: 2rem;
      color: var(--danger);
      background: none;
      border: none;
      cursor: pointer;
      z-index: 3;
      transition: color 0.2s;
    }
    .modal-close:hover {
      color: var(--primary-dark);
    }
    .modal-title {
      font-size: 1.8rem;
      font-weight: 700;
      color: var(--primary-dark);
      margin: 1rem 0 0.8rem 0;
      text-align: center;
    }
    .masampo-modal-header {
      font-size: 1.6rem;
      font-weight: 700;
      color: var(--primary-dark);
      margin-bottom: 0.8rem;
      text-align: center;
    }
    .modal-img {
      width: 80vw;
      max-width: 600px;
      height: auto;
      max-height: 400px;
      object-fit: cover;
      border-radius: 9px;
      margin-bottom: 0.5rem;
      border: 1.5px solid #eee;
      background: #fff;
    }
    .modal-img[onerror] {
      content: url('https://via.placeholder.com/600x400?text=Image+Not+Found');
    }
    .modal-imgs {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 0.3rem;
      flex-wrap: nowrap;
      justify-content: center;
      max-width: 100%;
      overflow-x: auto;
      padding: 0.5rem;
      scrollbar-width: thin;
    }
    .modal-imgs::-webkit-scrollbar {
      height: 6px;
    }
    .modal-imgs::-webkit-scrollbar-thumb {
      background: var(--primary-light);
      border-radius: 4px;
    }
    .modal-imgs img {
      width: 60px;
      height: 60px;
      object-fit: cover;
      border-radius: 4px;
      border: 2px solid var(--primary-light);
      cursor: pointer;
      transition: box-shadow 0.15s;
      background: #fff;
      flex-shrink: 0;
    }
    .modal-imgs img[onerror] {
      content: url('https://via.placeholder.com/60x60?text=Image+Not+Found');
    }
    .modal-imgs img.selected {
      box-shadow: 0 0 0 3px var(--primary);
    }
    .modal-slider-arrows {
      display: flex;
      gap: 8px;
      align-items: center;
      margin-bottom: 0.3rem;
      margin-top: 0.1rem;
    }
    .modal-slider-arrow {
      background: var(--primary-light);
      border: none;
      border-radius: 50%;
      width: 32px;
      height: 32px;
      font-size: 1.2rem;
      cursor: pointer;
      color: #fff;
      transition: background 0.18s;
    }
    .modal-slider-arrow:hover {
      background: var(--primary-dark);
    }
    .modal-slider-arrow:disabled {
      background: #ddd;
      color: #aaa;
      cursor: not-allowed;
    }
    .masampo-bid-block {
      margin: 0.7rem 0 0.2rem 0;
      width: 100%;
      max-width: 500px;
    }
    .masampo-bid-block input,
    .masampo-bid-block label {
      display: block;
      width: 100%;
      font-size: 1.1rem;
      margin-bottom: 0.55rem;
    }
    .masampo-bid-block label {
      font-weight: 500;
    }
    .masampo-bid-block .bid-actions {
      display: flex;
      gap: 14px;
      justify-content: center;
      margin-top: 0.4rem;
      flex-wrap: wrap;
    }
    .bid-status {
      margin: 0.4rem auto 0.1rem auto;
      text-align: center;
      font-size: 1.02em;
    }
    .bid-status.success {
      color: var(--primary-dark);
    }
    .bid-status.error {
      color: var(--danger);
    }
    .bid-label {
      font-size: 0.95em;
      color: var(--text-light);
      margin-bottom: 8px;
      display: block;
    }
    .bid-dest-label {
      font-weight: 600;
      font-size: 0.99em;
      margin-bottom: 3px;
    }
    footer {
      background: var(--footer-bg);
      color: var(--footer-text);
      text-align: center;
      padding: 1.5rem 1rem 1.7rem 1rem;
      border-radius: 18px 18px 0 0;
      font-size: 1.08rem;
      margin-top: 2.7rem;
      box-shadow: 0 -2px 8px rgba(0,0,0,0.04);
    }
    footer a {
      color: var(--footer-link);
      text-decoration: underline;
      font-weight: 500;
    }
    footer .footer-brand {
      font-weight: bold;
      color: var(--footer-link);
    }
    @media (max-width: 800px) {
      .modal-content {
        padding: 1rem;
        max-width: 95vw;
        max-height: 95vh;
      }
      .modal-title {
        font-size: 1.5rem;
      }
      .modal-img {
        width: 90vw;
        max-width: 400px;
        max-height: 250px;
      }
      .modal-imgs img {
        width: 50px;
        height: 50px;
      }
      .container {
        margin: 1rem auto;
      }
      .cart {
        min-width: 100%;
      }
      .checkout-btn-sms .fa-comment,
      .checkout-btn-whatsapp .fa-whatsapp {
        font-size: 12px;
      }
    }
    @media (max-width: 400px) {
      .modal-imgs img {
        width: 45px;
        height: 45px;
      }
      .product img,
      .vehicle-item img {
        width: 120px;
        height: 80px;
      }
      .checkout-btn-sms,
      .checkout-btn-whatsapp {
        font-size: 0.9rem;
        padding: 0 6px;
      }
      .checkout-btn-sms .fa-comment,
      .checkout-btn-whatsapp .fa-whatsapp {
        font-size: 11px;
        margin-right: 4px;
      }
      .checkout-actions,
      .bid-actions {
        gap: 10px;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="brand-title">Zam<span class="highlight">Listing</span></div>
    <h2 class="tagline">Get your Service</h2>
    <p class="subtitle">Click on a service below to proceed</p>
  </header>
  <div class="container">
    <div class="filter-search-section">
      <div>
        <label for="categoryFilter">Show Section:</label>
        <select id="categoryFilter" aria-label="Filter by category">
          <option value="all">All</option>
          <option value="taxi">Taxi Hire</option>
          <option value="masampo">Masampo</option>
          <option value="bistore">B-istore</option>
        </select>
        <input type="text" id="searchBox" placeholder="Search products, vehicles..." aria-label="Search products, vehicles">
      </div>
    </div>
    <!-- Masampo Section -->
    <div class="slider-section" id="masampoSliderSection">
      <div class="slider-title">Masampo</div>
      <button class="slider-btn prev" id="prevMasampoBtn" aria-label="Scroll left"><i class="fa fa-chevron-left"></i></button>
      <div class="slider-track" id="masampo-slider-track"></div>
      <button class="slider-btn next" id="nextMasampoBtn" aria-label="Scroll right"><i class="fa fa-chevron-right"></i></button>
    </div>
    <!-- B-istore Section -->
    <div class="slider-section" id="bistoreSliderSection">
      <div class="slider-title">B-istore</div>
      <button class="slider-btn prev" id="prevBistoreBtn" aria-label="Scroll left"><i class="fa fa-chevron-left"></i></button>
      <div class="slider-track" id="bistore-slider-track"></div>
      <button class="slider-btn next" id="nextBistoreBtn" aria-label="Scroll right"><i class="fa fa-chevron-right"></i></button>
    </div>
    <!-- Cart System -->
    <div class="cart" aria-label="Your Cart">
      <h2 class="section-title">Your Order</h2>
      <ul id="cart-items" class="cart-items"></ul>
      <div id="empty-cart" class="empty-cart" aria-live="polite">
        <p>Cart Empty</p>
        <p>Add items to get started.</p>
      </div>
      <div id="cart-total" class="cart-total" style="display:none;">
        <p>Products Total: ZK <span id="products-total">0.00</span></p>
        <p><strong>Total: ZK <span id="grand-total">0.00</span></strong></p>
      </div>
      <div class="checkout-actions" id="checkoutActions" style="display:none;">
        <button class="checkout-btn-sms" id="checkout-btn-sms" title="Send order via SMS" aria-label="Send order via SMS">
          <i class="fa fa-comment"></i> Send via SMS
        </button>
        <button class="checkout-btn-whatsapp" id="checkout-btn-whatsapp" title="Send order via WhatsApp" aria-label="Send order via WhatsApp">
          <i class="fa fa-whatsapp"></i> Send via WhatsApp
        </button>
      </div>
      <div id="statusMessage" class="status-message" aria-live="polite"></div>
    </div>
    <!-- Taxi Hire Section -->
    <div class="slider-section" id="taxiSliderSection">
      <div class="slider-title">Taxi Hire</div>
      <button class="slider-btn prev" id="prevTaxiBtn" aria-label="Scroll left"><i class="fa fa-chevron-left"></i></button>
      <div class="slider-track" id="taxi-slider-track">
        <div class="taxi-card" id="taxiCard">
          <span class="taxi-card-title">Book a Taxi</span>
          <span class="taxi-card-desc">Hire a vehicle for your trip. Quick, safe, and affordable!</span>
        </div>
      </div>
      <button class="slider-btn next" id="nextTaxiBtn" aria-label="Scroll right"><i class="fa fa-chevron-right"></i></button>
    </div>
    <!-- Masampo Details Modal -->
    <div class="modal" id="detailsModal">
      <div class="modal-content">
        <button class="modal-close" id="detailsModalClose" aria-label="Close modal">&times;</button>
        <div class="masampo-modal-header">Masampo Details</div>
        <div class="modal-title" id="detailsModalTitle"></div>
        <img id="detailsModalImg" class="modal-img" src="" alt="Item Image">
        <div class="modal-imgs" id="detailsModalImgs"></div>
        <div class="modal-slider-arrows" id="detailsModalArrows" style="display:none;">
          <button class="modal-slider-arrow" id="detailsModalPrevImg" aria-label="Previous image">&lt;</button>
          <button class="modal-slider-arrow" id="detailsModalNextImg" aria-label="Next image">&gt;</button>
        </div>
        <div class="modal-details" id="detailsModalDetails"></div>
        <div id="masampoBidBlock" class="masampo-bid-block" style="display:none;">
          <span class="bid-label">Bid/Order will be sent to:</span>
          <span class="bid-dest-label" id="masampoBidDestLabel"></span>
          <label for="masampoBidValue">Your Bid Value (ZK):</label>
          <input type="number" min="1" id="masampoBidValue" placeholder="Enter bid value" aria-label="Enter bid value">
          <label for="masampoBidPhone">Your Phone Number:</label>
          <input type="tel" id="masampoBidPhone" maxlength="10" placeholder="e.g. 0978000000" aria-label="Enter phone number">
          <div class="bid-actions">
            <button class="checkout-btn-sms" id="masampoBidSms" title="Send bid via SMS" aria-label="Send bid via SMS">
              <i class="fa fa-comment"></i> Send via SMS
            </button>
            <button class="checkout-btn-whatsapp" id="masampoBidWhatsapp" title="Send bid via WhatsApp" aria-label="Send bid via WhatsApp">
              <i class="fa fa-whatsapp"></i> Send via WhatsApp
            </button>
          </div>
          <div class="bid-status" id="masampoBidStatus" aria-live="polite"></div>
        </div>
      </div>
    </div>
  </div>
  <footer>
    <div class="footer-brand">ZamListing</div>
    <div>
      &copy; 2025 ZamListing &middot; Powered by <a href="https://github.com/">GitHub</a>
    </div>
    <div>
      <span>Contact: <a href="mailto:support@zamlisting.com">support@zamlisting.com</a></span>
    </div>
  </footer>
  <script>
    // --- Masampo Items ---
    const masampoItems = [
      {
        id: 1011,
        name: "Vitz Ndola",
        price: 90000,
        location: "Ndola",
        image: "V1.jpg",
        category: "vehicle",
        details: { condition: "For Sale", contact: "+260978167546" },
        additionalImages: ["V1.jpg", "V2.jpg", "V3.jpg", "V4.jpg", "V5.jpg", "V6.jpg"],
        listedDate: "2025-08-12"
      },
      {
        id: 1012,
        name: "Laptop Lusaka",
        price: 1200,
        location: "Lusaka",
        image: "L1.jpeg",
        category: "laptop",
        details: { condition: "11.6-inch, 4 GB RAM", contact: "+260978167546" },
        additionalImages: ["L1.jpeg", "L2.jpeg", "L3.jpeg", "L4.jpeg", "L5.jpeg", "L6.jpeg"],
        listedDate: "2025-08-12"
      },
      {
        id: 1013,
        name: "Samsung S24",
        price: 26000,
        location: "Lusaka",
        image: "S241.webp",
        category: "phone",
        details: { condition: "For Sale - Negotiable", contact: "+260978167546" },
        additionalImages: ["S241.webp", "S242.webp", "S243.webp", "S244.webp", "S245.webp", "S246.webp"],
        listedDate: "2025-08-12"
      },
      {
        id: 1014,
        name: "Villaon V20 SE",
        price: 600,
        location: "Lusaka",
        image: "V201.jpeg",
        category: "phone",
        details: { condition: "6.3-inch LCD, 2 GB RAM", contact: "+260978167546" },
        additionalImages: ["V201.jpeg", "V202.jpeg", "V203.jpeg", "V204.jpeg", "V205.jpeg", "V206.jpeg"],
        listedDate: "2025-08-12"
      },
      {
        id: 1017,
        name: "CASIO GX-14 Calculator",
        price: 230,
        location: "Luangwa",
        image: "GX.jpg",
        category: "calculator",
        details: { condition: "14 Digits", contact: "+260978167546" },
        additionalImages: ["GX.jpg", "GX2.jpg", "GX3.jpg", "GX4.jpg", "GX5.jpg", "GX6.jpg"],
        listedDate: "2025-08-12"
      }
    ];

    // --- B-istore Items ---
    const bistoreItems = [
      { id: 1, name: "Mosi Beer", price: 25, image: "M.jpeg", category: "beverages", stock: 100 },
      { id: 2, name: "Castle Lager", price: 24, image: "CC.jpeg", category: "beverages", stock: 100 },
      { id: 3, name: "Coca-Cola Bottled", price: 12, image: "MC.jpg", category: "beverages", stock: 100 },
      { id: 4, name: "Blue Pen", price: 3, image: "pen2.png", category: "stationary", stock: 200 },
      { id: 5, name: "Ream of Paper", price: 80, image: "ream.jpeg", category: "stationary", stock: 50 }
    ];

    // --- Utility Functions ---
    function debounce(func, wait) {
      let timeout;
      return function executedFunction(...args) {
        const later = () => {
          clearTimeout(timeout);
          func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
      };
    }

    // --- Taxi Hire Logic ---
    const taxiCard = document.getElementById('taxiCard');
    taxiCard.onclick = () => {
      window.location.href = 'https://zamlisting.com/customerride';
    };

    // --- Masampo Logic ---
    const masampoSliderTrack = document.getElementById('masampo-slider-track');
    const prevMasampoBtn = document.getElementById('prevMasampoBtn');
    const nextMasampoBtn = document.getElementById('nextMasampoBtn');

    function renderMasampoItems(items) {
      masampoSliderTrack.innerHTML = '';
      items.forEach(item => {
        const card = document.createElement('div');
        card.className = 'vehicle-item';
        card.innerHTML = `
          <img src="${item.image}" alt="${item.name}" onerror="this.src='https://via.placeholder.com/140x100?text=Image+Not+Found'">
          <h4>${item.name}</h4>
          <p>ZK ${item.price.toLocaleString()}</p>
          <p class="location">${item.location}</p>
          <button onclick="showDetailsModal(${item.id}, 'masampo')" aria-label="View details of ${item.name}">View Details</button>
        `;
        masampoSliderTrack.appendChild(card);
      });
      updateSliderButtons('masampo');
    }

    // --- B-istore Logic ---
    const bistoreSliderTrack = document.getElementById('bistore-slider-track');
    const prevBistoreBtn = document.getElementById('prevBistoreBtn');
    const nextBistoreBtn = document.getElementById('nextBistoreBtn');

    function renderBistoreItems(items) {
      bistoreSliderTrack.innerHTML = '';
      items.forEach(item => {
        const card = document.createElement('div');
        card.className = 'product';
        card.innerHTML = `
          <img src="${item.image}" alt="${item.name}" onerror="this.src='https://via.placeholder.com/140x100?text=Image+Not+Found'">
          <h4>${item.name}</h4>
          <p>ZK ${item.price.toFixed(2)}</p>
          ${item.stock === 0 ? '<span class="out-stock">Out of Stock</span>' : ''}
          <button onclick="addToCart(${item.id})" ${item.stock === 0 ? 'disabled' : ''} aria-label="Add ${item.name} to cart">Add to Cart</button>
        `;
        bistoreSliderTrack.appendChild(card);
      });
      updateSliderButtons('bistore');
    }

    // --- Cart Logic ---
    let cart = [];

    function addToCart(id) {
      const item = bistoreItems.find(i => i.id === id);
      if (!item || item.stock === 0) {
        document.getElementById('statusMessage').textContent = 'Item is out of stock';
        document.getElementById('statusMessage').classList.add('error');
        document.getElementById('statusMessage').classList.remove('success');
        return;
      }
      const cartItem = cart.find(i => i.id === id);
      if (cartItem) {
        if (cartItem.quantity < item.stock) {
          cartItem.quantity += 1;
        } else {
          document.getElementById('statusMessage').textContent = 'Maximum stock reached';
          document.getElementById('statusMessage').classList.add('error');
          document.getElementById('statusMessage').classList.remove('success');
          return;
        }
      } else {
        cart.push({ ...item, quantity: 1 });
      }
      renderCart();
      document.getElementById('statusMessage').textContent = `${item.name} added to cart`;
      document.getElementById('statusMessage').classList.add('success');
      document.getElementById('statusMessage').classList.remove('error');
    }

    function updateCartItem(id, quantity) {
      const item = bistoreItems.find(i => i.id === id);
      const cartItem = cart.find(i => i.id === id);
      if (cartItem && quantity <= item.stock && quantity >= 1) {
        cartItem.quantity = quantity;
        renderCart();
      }
    }

    function removeFromCart(id) {
      cart = cart.filter(i => i.id !== id);
      renderCart();
      document.getElementById('statusMessage').textContent = 'Item removed from cart';
      document.getElementById('statusMessage').classList.add('success');
      document.getElementById('statusMessage').classList.remove('error');
    }

    function renderCart() {
      const cartItems = document.getElementById('cart-items');
      const emptyCart = document.getElementById('empty-cart');
      const cartTotal = document.getElementById('cart-total');
      const checkoutActions = document.getElementById('checkoutActions');
      cartItems.innerHTML = '';
      if (cart.length === 0) {
        emptyCart.style.display = 'block';
        cartTotal.style.display = 'none';
        checkoutActions.style.display = 'none';
      } else {
        emptyCart.style.display = 'none';
        cartTotal.style.display = 'block';
        checkoutActions.style.display = 'flex';
        cart.forEach(item => {
          const li = document.createElement('li');
          li.innerHTML = `
            <div class="cart-item-info">
              <img src="${item.image}" alt="${item.name}" class="cart-thumb" onerror="this.src='https://via.placeholder.com/36x36?text=Image+Not+Found'">
              <span class="cart-item-title">${item.name}</span>
            </div>
            <div class="cart-price-block">
              <span>ZK ${(item.price * item.quantity).toFixed(2)}</span>
              <div class="quantity-controls">
                <button class="quantity-btn" onclick="updateCartItem(${item.id}, ${item.quantity - 1})" aria-label="Decrease quantity">-</button>
                <input type="number" class="cart-item-qty" value="${item.quantity}" min="1" max="${item.stock}" onchange="updateCartItem(${item.id}, this.value)" aria-label="Quantity">
                <button class="quantity-btn" onclick="updateCartItem(${item.id}, ${item.quantity + 1})" aria-label="Increase quantity">+</button>
                <button class="remove-btn" onclick="removeFromCart(${item.id})" aria-label="Remove item">✕</button>
              </div>
            </div>
          `;
          cartItems.appendChild(li);
        });
        const total = cart.reduce((sum, item) => sum + item.price * item.quantity, 0);
        document.getElementById('products-total').textContent = total.toFixed(2);
        document.getElementById('grand-total').textContent = total.toFixed(2);
      }
    }

    function sendOrder(method) {
      if (cart.length === 0) {
        document.getElementById('statusMessage').textContent = 'Your cart is empty';
        document.getElementById('statusMessage').classList.add('error');
        document.getElementById('statusMessage').classList.remove('success');
        return;
      }
      const orderDetails = cart.map(item => `${item.name} (Qty: ${item.quantity}, ZK ${item.price * item.quantity})`).join(', ');
      const total = cart.reduce((sum, item) => sum + item.price * item.quantity, 0).toFixed(2);
      const message = `Order: ${orderDetails}, Total: ZK ${total}`;
      try {
        if (method === 'sms') {
          window.location.href = `sms:+260978167546?body=${encodeURIComponent(message)}`;
        } else {
          window.open(`https://wa.me/+260978167546?text=${encodeURIComponent(message)}`, '_blank');
        }
        document.getElementById('statusMessage').textContent = `Order sent via ${method.toUpperCase()}!`;
        document.getElementById('statusMessage').classList.add('success');
        document.getElementById('statusMessage').classList.remove('error');
      } catch (e) {
        document.getElementById('statusMessage').textContent = 'Failed to send order. Please try again.';
        document.getElementById('statusMessage').classList.add('error');
        document.getElementById('statusMessage').classList.remove('success');
      }
    }

    document.getElementById('checkout-btn-sms').onclick = () => {
      document.getElementById('checkout-btn-sms').disabled = true;
      sendOrder('sms');
      setTimeout(() => document.getElementById('checkout-btn-sms').disabled = false, 2000);
    };

    document.getElementById('checkout-btn-whatsapp').onclick = () => {
      document.getElementById('checkout-btn-whatsapp').disabled = true;
      sendOrder('whatsapp');
      setTimeout(() => document.getElementById('checkout-btn-whatsapp').disabled = false, 2000);
    };

    // --- Modal Logic ---
    const detailsModal = document.getElementById('detailsModal');
    const detailsModalClose = document.getElementById('detailsModalClose');
    const detailsModalTitle = document.getElementById('detailsModalTitle');
    const detailsModalImg = document.getElementById('detailsModalImg');
    const detailsModalImgs = document.getElementById('detailsModalImgs');
    const detailsModalArrows = document.getElementById('detailsModalArrows');
    const detailsModalPrevImg = document.getElementById('detailsModalPrevImg');
    const detailsModalNextImg = document.getElementById('detailsModalNextImg');
    const detailsModalDetails = document.getElementById('detailsModalDetails');
    const masampoBidBlock = document.getElementById('masampoBidBlock');
    const masampoBidDestLabel = document.getElementById('masampoBidDestLabel');
    const masampoBidValue = document.getElementById('masampoBidValue');
    const masampoBidPhone = document.getElementById('masampoBidPhone');
    const masampoBidSms = document.getElementById('masampoBidSms');
    const masampoBidWhatsapp = document.getElementById('masampoBidWhatsapp');
    const masampoBidStatus = document.getElementById('masampoBidStatus');

    function showDetailsModal(id, type) {
      const item = type === 'masampo' ? masampoItems.find(i => i.id === id) : bistoreItems.find(i => i.id === id);
      if (!item) {
        detailsModalTitle.textContent = 'Item not found';
        detailsModalImg.src = '';
        detailsModalImgs.innerHTML = '';
        detailsModalArrows.style.display = 'none';
        detailsModalDetails.innerHTML = '';
        masampoBidBlock.style.display = 'none';
        detailsModal.classList.add('show');
        return;
      }
      detailsModalTitle.textContent = item.name;
      detailsModalImg.src = item.image;
      detailsModalImgs.innerHTML = '';
      const images = type === 'masampo' && item.additionalImages ? [item.image, ...item.additionalImages.slice(0, 5)] : [item.image];
      detailsModalArrows.style.display = type === 'masampo' && images.length > 1 ? 'flex' : 'none';

      images.forEach((img, index) => {
        const imgElement = document.createElement('img');
        imgElement.src = img;
        imgElement.alt = `${item.name} image ${index + 1}`;
        imgElement.className = index === 0 ? 'selected' : '';
        imgElement.onerror = () => { imgElement.src = 'https://via.placeholder.com/60x60?text=Image+Not+Found'; };
        imgElement.onclick = () => changeModalImage(img, images);
        detailsModalImgs.appendChild(imgElement);
      });

      function changeModalImage(src, images) {
        detailsModalImg.src = src;
        const thumbs = detailsModalImgs.querySelectorAll('img');
        thumbs.forEach(thumb => thumb.className = thumb.src === src ? 'selected' : '');
        detailsModalPrevImg.disabled = images.indexOf(src) === 0;
        detailsModalNextImg.disabled = images.indexOf(src) === images.length - 1;
        const selectedThumb = detailsModalImgs.querySelector('img.selected');
        if (selectedThumb) {
          selectedThumb.scrollIntoView({ behavior: 'smooth', inline: 'center' });
        }
      }

      detailsModalPrevImg.onclick = () => {
        const currentIndex = images.indexOf(detailsModalImg.src);
        if (currentIndex > 0) changeModalImage(images[currentIndex - 1], images);
      };

      detailsModalNextImg.onclick = () => {
        const currentIndex = images.indexOf(detailsModalImg.src);
        if (currentIndex < images.length - 1) changeModalImage(images[currentIndex + 1], images);
      };

      let detailsHtml = `<p>Price: ZK ${item.price.toLocaleString()}</p>`;
      if (type === 'masampo') {
        detailsHtml += `<p>Location: ${item.location}</p>`;
        detailsHtml += `<p>Category: ${item.category}</p>`;
        detailsHtml += `<p>Listed: ${item.listedDate}</p>`;
        if (item.details) {
          Object.entries(item.details).forEach(([key, value]) => {
            if (key !== 'contact') detailsHtml += `<p>${key.charAt(0).toUpperCase() + key.slice(1)}: ${value}</p>`;
          });
        }
        masampoBidBlock.style.display = 'block';
        masampoBidDestLabel.textContent = item.details?.contact || 'N/A';
        masampoBidValue.value = '';
        masampoBidPhone.value = '';
        masampoBidStatus.textContent = '';
      } else {
        detailsHtml += `<p>Category: ${item.category}</p>`;
        detailsHtml += `<p>Stock: ${item.stock}</p>`;
        masampoBidBlock.style.display = 'none';
      }
      detailsModalDetails.innerHTML = detailsHtml;
      detailsModal.classList.add('show');
    }

    detailsModalClose.onclick = () => {
      detailsModal.classList.remove('show');
      masampoBidStatus.textContent = '';
    };

    function sendBid(method) {
      const bidValue = masampoBidValue.value;
      const phone = masampoBidPhone.value;
      const itemName = detailsModalTitle.textContent;
      const contact = masampoBidDestLabel.textContent;
      if (!bidValue || bidValue <= 0) {
        masampoBidStatus.textContent = 'Please enter a valid bid value';
        masampoBidStatus.classList.add('error');
        masampoBidStatus.classList.remove('success');
        return;
      }
      if (!phone || phone.length !== 10) {
        masampoBidStatus.textContent = 'Please enter a valid 10-digit phone number';
        masampoBidStatus.classList.add('error');
        masampoBidStatus.classList.remove('success');
        return;
      }
      const message = `Bid for ${itemName}: ZK ${bidValue}, Phone: ${phone}`;
      try {
        if (method === 'sms') {
          window.location.href = `sms:${contact}?body=${encodeURIComponent(message)}`;
        } else {
          window.open(`https://wa.me/${contact}?text=${encodeURIComponent(message)}`, '_blank');
        }
        masampoBidStatus.textContent = `Bid sent via ${method.toUpperCase()}!`;
        masampoBidStatus.classList.add('success');
        masampoBidStatus.classList.remove('error');
      } catch (e) {
        masampoBidStatus.textContent = 'Failed to send bid. Please try again.';
        masampoBidStatus.classList.add('error');
        masampoBidStatus.classList.remove('success');
      }
    }

    masampoBidSms.onclick = () => {
      masampoBidSms.disabled = true;
      sendBid('sms');
      setTimeout(() => masampoBidSms.disabled = false, 2000);
    };

    masampoBidWhatsapp.onclick = () => {
      masampoBidWhatsapp.disabled = true;
      sendBid('whatsapp');
      setTimeout(() => masampoBidWhatsapp.disabled = false, 2000);
    };

    // --- Slider Logic ---
    function updateSliderButtons(section) {
      const track = document.getElementById(`${section}-slider-track`);
      const prevBtn = document.getElementById(`prev${section.charAt(0).toUpperCase() + section.slice(1)}Btn`);
      const nextBtn = document.getElementById(`next${section.charAt(0).toUpperCase() + section.slice(1)}Btn`);
      prevBtn.disabled = track.scrollLeft <= 0;
      nextBtn.disabled = track.scrollLeft + track.clientWidth >= track.scrollWidth;
    }

    function setupSlider(section) {
      const track = document.getElementById(`${section}-slider-track`);
      const prevBtn = document.getElementById(`prev${section.charAt(0).toUpperCase() + section.slice(1)}Btn`);
      const nextBtn = document.getElementById(`next${section.charAt(0).toUpperCase() + section.slice(1)}Btn`);
      prevBtn.onclick = () => {
        track.scrollBy({ left: -200, behavior: 'smooth' });
        setTimeout(() => updateSliderButtons(section), 300);
      };
      nextBtn.onclick = () => {
        track.scrollBy({ left: 200, behavior: 'smooth' });
        setTimeout(() => updateSliderButtons(section), 300);
      };
      track.onscroll = () => updateSliderButtons(section);
    }

    setupSlider('taxi');
    setupSlider('masampo');
    setupSlider('bistore');

    // --- Filter and Search Logic ---
    const categoryFilter = document.getElementById('categoryFilter');
    const searchBox = document.getElementById('searchBox');

    function filterAndSearch() {
      const category = categoryFilter.value;
      const searchTerm = searchBox.value.toLowerCase();

      // Show/hide sections based on category
      document.getElementById('taxiSliderSection').style.display = category === 'all' || category === 'taxi' ? 'block' : 'none';
      document.getElementById('masampoSliderSection').style.display = category === 'all' || category === 'masampo' ? 'block' : 'none';
      document.getElementById('bistoreSliderSection').style.display = category === 'all' || category === 'bistore' ? 'block' : 'none';

      // Filter Masampo items
      const filteredMasampo = masampoItems.filter(item => {
        const matchesSearch = item.name.toLowerCase().includes(searchTerm) || item.location.toLowerCase().includes(searchTerm) || item.category.toLowerCase().includes(searchTerm);
        return (category === 'all' || category === 'masampo') && matchesSearch;
      });
      renderMasampoItems(filteredMasampo);

      // Filter B-istore items
      const filteredBistore = bistoreItems.filter(item => {
        const matchesSearch = item.name.toLowerCase().includes(searchTerm) || item.category.toLowerCase().includes(searchTerm);
        return (category === 'all' || category === 'bistore') && matchesSearch;
      });
      renderBistoreItems(filteredBistore);
    }

    categoryFilter.onchange = filterAndSearch;
    searchBox.oninput = debounce(filterAndSearch, 300);

    // Initial render
    renderMasampoItems(masampoItems);
    renderBistoreItems(bistoreItems);
    renderCart();

    // Fallback for Font Awesome loading failure
    window.addEventListener('load', () => {
      if (typeof FontAwesome === 'undefined') {
        document.querySelectorAll('.fa').forEach(icon => {
          icon.style.display = 'inline-block';
          icon.style.width = '24px';
          icon.style.height = '24px';
          icon.style.background = '#ccc';
          icon.style.borderRadius = '50%';
          icon.style.textAlign = 'center';
          icon.style.lineHeight = '24px';
          icon.style.color = '#fff';
          if (icon.classList.contains('fa-whatsapp')) icon.textContent = 'WA';
          else if (icon.classList.contains('fa-comment')) icon.textContent = 'SMS';
          else if (icon.classList.contains('fa-chevron-left')) icon.textContent = '<';
          else if (icon.classList.contains('fa-chevron-right')) icon.textContent = '>';
          else icon.textContent = '?';
        });
      }
    });
  </script>
</body>
</html>
